<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Outbound Clipboard Manager</title>
  <link rel="icon" type="image/x-icon" href="https://joshua-reeve.github.io/OCM/favicon.ico">
  
<style>

/* General Typography */
body, html {
  font-family: 'Roboto', Arial, Helvetica, sans-serif; /* Material font */
  font-size: 16px; /* Base font size */
  line-height: 1.5; /* Improved readability */
  color: #212121; /* Dark text for better contrast */
  margin: 0;
  padding: 0;
  background-color: #fafafa; /* Material Design light background */
}
.sub-label {
  font-weight: bold;
  margin-top: 5px;
  margin-bottom: 2px;
  color: #2c3e50;
  font-size: 0.9em;
  letter-spacing: 0.1px;
}

/* Buttons */
.folder-div {
  border-radius: 4px !important;  /* Try 16px, 24px, 999px for pill shape */
  overflow: hidden; /* optional, to ensure inner content matches the radius */
  border: 3px solid #2196f3;
  background: #f6f6f6;
  margin: 5px 0;
}
.folder-div.dragging {
  opacity: 0.7;
  box-shadow: 0 4px 18px rgba(33,150,243,0.20);
}
.folder-div.folder-drop-target {
  border-color: #ffd600;
  background: #fffde7;
}
.folder-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0px;
  cursor: pointer;
  font-size: 1.1em;
  background: #2196f3;
  color: #fff;
  user-select: none;
  transition: background 0.2s;
}
.folder-header .controls button,
.copy-box button,
.folder-header .controls button .material-symbols-outlined,
.copy-box button .material-symbols-outlined {
  font-size: 18px;
  border: none;
  outline: none;
  cursor: pointer;
  border-radius: 5px;
  padding: 3px 3px;
  margin: 1px 1px;
  transition: filter 0.15s;
}
.folder-header .controls button:hover,
.copy-box button:hover {
  filter: brightness(0.95);
}
.buttons-list {
  min-height: 10px;
  padding: 1px;
  background: #f6f6f6;
  border-radius: 0 0 8px 8px;
  display: flex;
  flex-direction: column;
  gap: 0px;
  transition: background 0.2s;
}
.buttons-list.button-drop-target {
  background: #fffde7;
}

#foldersContainer {
  margin-bottom: 0px;
}
#inlineAddFolderForm {
  display: flex;
  gap: 0px;
  margin-bottom: 0px;
}

#inlineAddFolderForm input[type="color"] {
  width: 36px;
  height: 36px;
  padding: 0;
  border: none;
  background: none;
  flex: 0 0 36px;
  cursor: pointer;
}

  .button-container {
    display: flex;
    align-items: center;
    margin: 0px 0;
    border: 0px solid #ccc;
    padding: 0px;
    background-color: 8fd4ff;
    width: fit-content;
  }
  .button-container:hover {
    background-color: 8fd4ff;
  }
.copy-box {
  border: none;
  padding: 5px;
  margin: 5px;
  border-radius: 4px;
  width: 95%;
  cursor: pointer;
  background-color: #2196F3;
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);
  text-align: center;
  font-family: 'Roboto', sans-serif;
  font-size: 14px;
  color: white;
  transition: transform 0.2s ease, background-color 0.3s ease, box-shadow 0.3s ease;
}

.copy-box:active {
  transform: scale(0.97);
  background-color: #1976D2;
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2);
}
.copy-box:hover {
  background-color: #64B5F6;
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
}

.copy-box span {
  flex: 1;
  font-weight: 500;
  font-size: 1em;
  user-select: none;
}
.copy-box div {
  display: flex;
  gap: 0px;
}
.copy-box button {
  background: none;
  border: none;
  cursor: pointer;
  color: #666;
  font-size: 20px;
  padding: 1px 2px;
  margin-left: 0px;
  transition: color 0.15s;
}

.copy-box-small {
  width: auto;
  font-size: 14px;
  padding: 5px;
  margin: 5px;
  display: inline-block;
  vertical-align: middle;
}
.delete-button {
  background-color: #F44336; /* Material Red 500 */
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2); /* Material elevation */
  color: white; /* White text for contrast */
  border: none;
  padding: 0px; /* Increase padding for better touch targets */
  margin: 0px;
  cursor: pointer;
  font-size: 50px;
  text-transform: uppercase; /* Material Design's uppercase text */
  border-radius: 4px; /* Standard corner radius */
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

.delete-button:hover {
  background-color: #D32F2F; /* Material Red 700 */
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2); /* Hover elevation */
}

.delete-button:active {
  background-color: #B71C1C; /* Material Red 900 */
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2); /* Press elevation */
}
.edit-button {
  background-color: #FDD835; /* Material Yellow 600 */
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2); /* Material elevation */
  color: #212121; /* Dark text for contrast */
  border: none;
  padding: 0px; /* Increase padding for better touch targets */
  margin: 3px auto;
  cursor: pointer;
  font-size: 14px;
  text-transform: uppercase; /* Material Design's uppercase text */
  border-radius: 4px; /* Standard corner radius */
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

.edit-button:hover {
  background-color: #FBC02D; /* Material Yellow 700 */
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2); /* Hover elevation */
}

.edit-button:active {
  background-color: #FBC02D; /* Material Yellow 700 */
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2); /* Press elevation */
}
button, .btn {
  background-color: #4CAF50; /* Material green */
  color: white;
  font-size: 14px;
  font-weight: 500;
  text-transform: uppercase;
  padding: 10px 24px;
  margin: 3px auto;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

button:hover, .btn:hover {
  background-color: #45A049; /* Darker green on hover */
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
}

button:disabled, .btn:disabled {
  background-color: #E0E0E0;
  color: #9E9E9E;
  cursor: not-allowed;
}
  form {
    margin-bottom: 0px;
  }
  .actions-bar {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-bottom: 1px;
}
/* Input Fields */
input[type="text"], textarea {
  width: 90%;
  padding: 10px;
  font-size: 14px;
  border: 1px solid #BDBDBD;
  border-radius: 4px;
  background-color: #FFFFFF;
  color: #212121;
  transition: border-color 0.3s ease;
  box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.1);
}
input[type="text"]:focus, textarea:focus {
  outline: none;
  width: 90%;
  padding: 10px;
  border-color: #4CAF50;
  box-shadow: 0px 2px 4px rgba(0, 153, 51, 0.2);
}
  button {
    padding: 5px 10px;
    cursor: pointer;
  }
textarea {
    width: 90%;
    height: 100px;
    padding: 10px;
    resize: vertical;
    font-family: sans-serif;
  }

  .drag-over {
  background-color: #f0f0f0;
  }
  .preview {
    position: absolute;
    background-color: #ffffff;
    border: 1px solid #ccc;
    padding: 5px;
    display: none;
    z-index: 1000;
  }

/* Foreground Section (Primary Card) */
.squircle-foreground {
  background-color: #FFFFFF; /* Material white for primary sections */
  padding: 16px; /* Standard Material Design padding */
  border-radius: 8px; /* Material-rounded corners */
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2); /* Material elevation */
  max-width: 600px;
  margin: 16px auto; /* Add spacing between sections */
  color: #212121; /* Dark text for contrast */
}

/* Background Section (Secondary Card) */
.squircle-background {
  background-color: #E3F2FD;
  padding: 16px; /* Standard Material Design padding */
  border-radius: 8px; /* Material-rounded corners */
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); /* Material elevation */
  max-width: 600px;
  margin: 16px auto; /* Consistent spacing between sections */
  color: #424242; /* Slightly lighter dark text */
}

 .phone-modal-foreground {
  background-color: #A5D6A7;
  padding: 10px;
  border-radius: 10px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.1);
  margin: 5px;
  max-width: 600px;
}

 .dotphrases-modal-foreground {
  background-color: #CE93D8;
  padding: 10px;
  border-radius: 10px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.1);
  margin: 5px;
  max-width: 600px;
}

.edit-container {
  background-color: #FFFFFF;
  padding: 16px;
  border-radius: 8px;
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
  width: 95%;
  max-width: 600px;
  margin: 16px auto;
  color: #212121;
}

/* General Styles for Communication Bubbles */
.danger {
  background-color: #FFEBEE; /* Material Red 50 */
  border-left: 6px solid #F44336; /* Material Red 500 */
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); /* Material elevation */
  margin-bottom: 16px;
  border-radius: 8px; /* Material rounded corners */
  padding: 12px 16px; /* Increased padding for readability */
  font-family: 'Roboto', sans-serif;
  color: #B71C1C; /* Material Red 900 for text */
}

.success {
  background-color: #E8F5E9; /* Material Green 50 */
  border-left: 6px solid #4CAF50; /* Material Green 500 */
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); /* Material elevation */
  margin-bottom: 16px;
  border-radius: 8px;
  padding: 12px 16px;
  font-family: 'Roboto', sans-serif;
  color: #1B5E20; /* Material Green 900 for text */
}

.info {
  background-color: #BBDEFB; /* Material Blue 100 - slightly darker */
  border-left: 6px solid #1976D2; /* Material Blue 700 */
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); /* Material elevation */
  margin-bottom: 16px;
  border-radius: 8px; /* Material-rounded corners */
  padding: 12px 16px; /* Increased padding for readability */
  font-family: 'Roboto', sans-serif;
  color: #0D47A1; /* Material Blue 900 for text */
}

.warning {
  background-color: #FFF8E1; /* Material Yellow 50 */
  border-left: 6px solid #FFC107; /* Material Amber 500 */
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); /* Material elevation */
  margin-bottom: 16px;
  border-radius: 8px;
  padding: 12px 16px;
  font-family: 'Roboto', sans-serif;
  color: #FF6F00; /* Material Amber 900 for text */
}

.webtext {
  background-color: #F3E5F5; /* Material Purple 50 */
  border-left: 6px solid #9C27B0; /* Material Purple 500 */
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1); /* Material elevation */
  margin-bottom: 16px;
  border-radius: 8px;
  padding: 12px 16px;
  font-family: 'Roboto', sans-serif;
  color: #4A148C; /* Material Purple 900 for text */
}

#mySidenav {
  position: sticky;
  top: 200px;
  right: 0;
  z-index: 999;
}

#mySidenav a {
  position: fixed;
  right: -160px; /* Start hidden on the right */
  transition: 0.3s; /* Smooth sliding effect */
  padding: 15px;
  width: 180px; /* Adjust width for icons and text */
  text-decoration: none; /* Remove underline */
  font-size: 18px; /* Font size for text */
  color: white; /* Text color */
  border-radius: 5px 0 0 5px; /* Rounded corners on the left */
  display: flex; /* Use flexbox for alignment */
  align-items: center; /* Vertically align icon and text */
  gap: 10px; /* Add space between the icon and text */
  z-index: 999;
}

#mySidenav a:hover {
  right: 0;
}

#richText {
  top: 60px;
  background-color: #FFD600;
}

#todoList {
  top: 120px;
  background-color: #2196F3;
}

#phoneNumbers {
  top: 120px;
  background-color: #04AA6D;
  font-size: 12px;
  
}
#dotPhrases {
  top: 180px; /* Adjust this value so it doesn't overlap with the others */
  background-color: #6a1b9a; /* Pick a color you like */
}
.material-symbols-outlined {
  display: block;
  font-size: 24px;
  color: white;
}
.modal {
  display: none;
  position: fixed;
  z-index: 1100;
  right: 0;
  top: 0;
  width: 600px;
  max-width: 100%;
  height: 100%;
  overflow: auto;
}
.modal-actions {
  position: Sticky;
  top: 0.5em;
  right: 0.5em;
  z-index: 1200;
  background: none;
  display: flex;
  justify-content: flex-end;
  align-items: flex-start;
}

.modal-close-btn {
  background: none;
  border: none;
  cursor: pointer;
  border-radius: 50%;
  padding: 4px;
  transition: background 0.2s;
  display: flex;
  align-items: center;
  position: absolute; top: 12px; right: 12px;
  justify-content: center;
}

.modal-close-btn .material-symbols-outlined {
  font-size: 28px;
  color: #888;
}

.modal-close-btn:hover {
  background: #eee;
}

.modal-close-btn:active {
  background: #e57373;
}

.modal-close-btn:hover .material-symbols-outlined {
  color: #d32f2f;
}
.modal-content {
  background-color: white;
  position: relative;
  top: 50%;
  transform: translateY(-50%);
  padding: 10px;
  z-index: 1150;
  border-radius: 8px;
  width: 90%;
  max-height: 95vh;
  max-width: 600px;
  right: -100%;
  transition: right 0.5s;
  overflow-y: auto;
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
}
.modal-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100vw; height: 100vh;
  background: rgba(0,0,0,0.3);
  z-index: 1175;
  display: flex;
  align-items: center;
  justify-content: center;
}
.modal-dialog, .modal-overlay form {
  background: #fff;
  padding: 24px 18px;
  border-radius: 12px;
  min-width: 320px;
  max-width: 90vw;
  box-shadow: 0 4px 32px rgba(0,0,0,0.18);
  margin: auto;
}


.modal.open .modal-content {
  right: 0;
}

@keyframes slide-in {
  from {
    right: -100%;
  }
  to {
    right: 0;
  }
}

@keyframes slide-out {
  from {
    right: 0; 
  }
  to {
    right: -100%;
  }
}

@media screen and (max-width: 600px) {
  .modal-content {
    width: 100%;
    min-width: unset;
  }
}




.rich-text-area {
  width: 90%;
  margin: 0 auto; 
  height: 150px; 
  padding: 10px;
  font-family: Arial, sans-serif;
  font-size: 16px;
  border: 1px solid #ccc;
  border-radius: 5px;
  display: block;
}

.todo-list {
  list-style-type: none;
  padding: 0;
}

.todo-list li {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
}

.todo-input {
  width: calc(100% - 30px);
  padding: 5px;
  font-size: 16px;
}

.todo-list-item {
  flex-grow: 1;
}

.todo-list-item.completed {
  text-decoration: line-through;
  color: gray;
}

.todo-delete {
  background-color: #f44336;
  color: white;
  border: none;
  padding: 5px;
  cursor: pointer;
  margin-left: 10px;
  border-radius: 3px;
}

.todo-delete:hover {
  background-color: #d32f2f;
}

.phone-section-card {
  background: #f6f6f6;
  border-radius: 8px;
  margin-bottom: 18px;
  box-shadow: 0 2px 8px rgba(33,150,243,0.07);
  padding: 14px 16px 8px 16px;
}
.phone-section-header {
  display: flex;
  align-items: center;
  font-size: 1.15em;
  margin-bottom: 8px;
  gap: 0.4em;
  color: #1976D2;
  font-weight: bold;
}
.phone-section-icon {
  background: #e3f2fd;
  color: #1976d2;
  border-radius: 50%;
  padding: 2px;
  margin-right: 4px;
}
.phone-number-row {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 4px;
  font-size: 1em;
}
.phone-number-grid {
  display: grid;
  grid-template-columns: max-content auto;
  gap: 6px 10px;
  align-items: center;
}
.interpreter-section ol, .interpreter-section ul {
  margin-left: 1.3em;
  margin-bottom: 0.5em;
}
/* Navigation (Topnav) */
.topnav {
  background-color: #FFFFFF;
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1);
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1000;
}

.topnav a {
  float: left;
  display: block;
  color: #212121;
  text-align: center;
  padding: 1px 5px;
  text-decoration: none;
  border-radius: 0px;
  font-weight: 500;
  text-transform: uppercase;
}

.topnav a:hover {
  background-color: #F0F0F0;
  color: #4CAF50;
}

.active {
  background-color: #04AA6D;
  color: white;
}

.topnav .icon {
  display: none;
}

.dropdown {
  float: left;
  border-radius: 0px;
  overflow: hidden;
}

.dropdown .dropbtn {
  font-size: 15px;    
  border: none;
  outline: none;
  color: black;
  background-color: inherit;
  font-family: inherit;
  margin: 0;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  float: none;
  color: black;
  padding: 5px 5px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.topnav a:hover, .dropdown:hover .dropbtn {
  background-color: #6495ED;
  color: white;
}

.dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.dropdown:hover .dropdown-content {
  display: block;
}

@media screen and (max-width: 5px) {
  .topnav a:not(:first-child), .dropdown .dropbtn {
    display: none;
  }
  .topnav a.icon {
    float: right;
    display: block;
  }
}

@media screen and (max-width: 5px) {
  .topnav.responsive {position: relative;}
  .topnav.responsive .icon {
    position: absolute;
    right: 0;
    top: 0;
  }
  .topnav.responsive a {
    float: none;
    display: block;
    text-align: left;
  }
  .topnav.responsive .dropdown {float: none;}
  .topnav.responsive .dropdown-content {position: relative;}
  .topnav.responsive .dropdown .dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
  /* Cards and Containers */
.card {
  background-color: white;
  border-radius: 8px;
  padding: 16px;
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
  margin-bottom: 16px;
}

/* Lists */
ul {
  list-style-type: none;
  padding: 0;
}

li {
  padding: 8px 16px;
  background: white;
  margin-bottom: 8px;
  border-radius: 4px;
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1);
}

/* Shadows and Elevation */
.elevation-1 {
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.1);
}

.elevation-2 {
  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);
}

.elevation-3 {
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
}
  /* Tables */	
.mdc-card {
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}
.mdc-data-table__table th,
.mdc-data-table__table td {
  border-bottom: 1px solid #e0e0e0;
}

.mdc-data-table__table tr:hover td {
}

    .preg-calc-container {
      max-width: 420px;
      margin: 0 auto;
      padding: 32px 10px 30px 10px;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 2px 18px rgba(33,150,243,0.1);
      margin-top: 24px;
      font-family: 'Roboto', Arial, sans-serif;
    }
    .preg-calc-container h2 {
      text-align: center;
      color: #1976d2;
      margin-bottom: 20px;
      letter-spacing: 0.02em;
      font-weight: 800;
    }
    .preg-calc-input-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 16px;
    }
    .preg-calc-container label {
      color: #1976d2; font-weight: 500; margin-bottom: 2px;
    }
    .preg-calc-container input[type="date"] {
      padding: 7px 10px;
      border: 1.5px solid #1976d2;
      border-radius: 6px;
      font-size: 1.06em;
    }
    .preg-calc-container button,
    .rob-copy-btn {
      padding: 9px 0;
      width: 100%;
      background: #1976d2;
      color: #fff;
      border: none;
      border-radius: 7px;
      font-size: 1.05em;
      font-weight: 700;
      cursor: pointer;
      margin-top: 5px;
      transition: background 0.17s;
    }
    .rob-copy-btn {
      width: auto;
      padding: 6px 12px;
      margin: 0;
      font-size: 0.98em;
      border-radius: 5px;
      margin-right: 6px;
      background: #1976d2;
      color: #fff;
    }
    .rob-copy-btn.copied {
      background: #388e3c !important;
      color: #fff !important;
    }
    .preg-calc-container button:hover, .rob-copy-btn:hover { background: #1256a6; }
    .preg-calc-results { margin-top: 28px; }
    .preg-calc-results table {
      width: 100%;
      border-collapse: collapse;
      background: #f6fafd;
      border-radius: 8px;
      font-size: 0.97em;
      overflow: hidden;
      margin-bottom: 12px;
    }
    .preg-calc-results th, .preg-calc-results td {
      padding-right: 10px;
      text-align: left;
      border-bottom: 1px solid #e3e3e3;

    }
	.preg-calc-results table td.date-range-col,
.preg-calc-results table th.date-range-col {
  padding-left: 10px;
}
    .preg-calc-results th {
      background: #e3f2fd;
      color: #1976d2;
      font-weight: 700;
      font-size: 1em;
    }
    .preg-calc-results tr:last-child td { border-bottom: none; }
    .appt-nob { color: #d81b60; font-weight: 700;}
    .appt-rob { color: #1976d2; }

    .preg-calc-results tbody tr:nth-child(odd) {
      background: #e3f2fd !important;
    }
    .preg-calc-results tbody tr:nth-child(even) {
      background: #fff !important;
    }
    .preg-calc-results th.date-range-col,
    .preg-calc-results td.date-range-col {
      text-align: right;
	  padding-left: 10px;
	  
    }

    .nob-step, .rob-step { display:none; }
    .active-step { display:block; }
    .nob-date-picker-info {
      color: #1976d2; 
      font-size: 1.01em;
      margin-bottom: 6px;
      font-weight: 500;
    }
    .nob-date-picker-warning {
      color: #d81b60;
      font-size: 0.97em;
      margin-top: 5px;
      margin-bottom: 5px;
      font-weight: 400;
    }
    @media (max-width: 520px) {
      .preg-calc-container { max-width: 99vw; border-radius:0; box-shadow:none; margin-top:0;}
      .preg-calc-container h2 { font-size: 1.01em; }
      .preg-calc-results table { font-size: 0.93em;}
      .preg-calc-results th, .preg-calc-results td { padding: 5px 2px;}
      .rob-copy-btn { font-size: 0.94em; padding: 5px 8px; }
    }
	
</style>

<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

   
  </head>
	
<body style="background-color: #ffffff;">

<div class="topnav" id="myTopnav">
  <a href="#section3" class="nav-link active">Go To:</a>
  <a href="#Custom Buttons">Custom Buttons</a>
  <a href="#Appt Notes">Appt Notes</a>
  <a href="#Email">Email</a>
  <div class="dropdown">
    <button class="dropbtn">Initiatives▾ 
      <i class="fa fa-caret-down"></i>
    </button>
    <div class="dropdown-content">
      <a href="#PT Wait List">PT Wait List</a>
    </div>
  </div>
  <div class="dropdown">
    <button class="dropbtn">SMS▾ 
      <i class="fa fa-caret-down"></i>
    </button>
    <div class="dropdown-content">
      <a href="#Bump Text SMS Messages">Bump Text SMS Messages</a>
      <a href="#Virtual Visit Change Texts">Virtual Visit Change Texts</a>
      <a href="#COVID InPatient Texts">COVID InPatient Texts</a>
      <a href="#RX Texts">RX Texts</a>
      <a href="#Web Scheduled Visit Texts">Web Scheduled Visit Texts</a>
      <a href="#Misc Texts and Responses">Misc Texts and Responses</a>
      <a href="#SMS PT Wait List">PT Wait List</a>
      <a href="#Inpatient Follow Up">Inpatient Follow Up</a>
      <a href="#Kidney Non Compliant">Kidney Non Compliant</a>
    </div>
  </div>
  <div class="dropdown">
    <button class="dropbtn">Utilities ▾
      <i class="fa fa-caret-down"></i>
    </button>
	<div class="dropdown-content">
      <a href="#NOB ROB Calculator">NOB/ROB Calculator</a>
    </div>
    <div class="dropdown-content">
      <a href="#Sleep Test Follow-up Calculator">Sleep Test Follow-up Calculator</a>
    </div>
  </div>
  <a href="#About">About</a>
  <a href="#Settings">Settings</a>
  <a href="javascript:void(0);" style="font-size:15px;" class="icon" onclick="myFunction()">&#9776;</a>
</div>
<script>
function myFunction() {
  var x = document.getElementById("myTopnav");
  if (x.className === "topnav") {
    x.className += " responsive";
  } else {
    x.className = "topnav";
  }
}
</script>
<div id="mySidenav" class="sidenav">
  <a href="#" id="richText" onclick="openModal('stickyNoteModal', '#FFFDE7')">
   <span class="material-symbols-outlined">sticky_note_2</span> Notes
  </a>  
  <a href="#" id="phoneNumbers" onclick="openModal('phoneNumbersModal', '#E8F5E9')">
    <span class="material-symbols-outlined">phone</span> Phone Numbers
  </a>
  <a href="#" id="dotPhrases" onclick="openModal('dotPhrasesModal', '#ede7f6')">
  <span class="material-symbols-outlined">more_horiz</span>
  Dot Phrases
</a>
</div>

<div id="stickyNoteModal" class="modal">
  <div class="modal-content">
    <div class="modal-actions">
      <button type="button" class="modal-close-btn" onclick="closeModal('stickyNoteModal')">
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>
    <h2>Notes:</h2>
    <textarea id="stickyNote" class="rich-text-area" placeholder="Type your notes here..."></textarea>
  </div>
</div>

<div id="phoneNumbersModal" class="modal">
  <div class="modal-content">
    <div class="modal-actions">
      <button type="button" class="modal-close-btn" onclick="closeModal('phoneNumbersModal')">
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>

    <h2 style="margin-bottom:16px;display:flex;align-items:center;gap:0.4em;">
      <span class="material-symbols-outlined" style="color:#1976d2;vertical-align:middle;font-size:32px;">phone</span>
      Phone Number Reference
    </h2>
	
    <!-- Support -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">support</span>
        <span>Support Lines:</span>
      </div>
      <div class="phone-number-grid">
        <div><b>Leader (Supervisor) Line:</b></div><div class="copy-box copy-box-small" data-message="801-213-4610">801-213-4610</div>
        <div><b>Outbound Support:</b></div><div class="copy-box copy-box-small" data-message="4-0556">4-0556</div>
		<div><b>Support:</b></div><div class="copy-box copy-box-small" data-message="801-213-4674">801-213-4674</div>
      </div>
    </div>

    <!-- General -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">call</span>
        <span>General</span>
      </div>
      <div class="phone-number-grid">
        <span>General Number:</span>
        <div class="copy-box copy-box-small" data-message="801-213-9500">801-213-9500</div>
      </div>
    </div>

    <!-- Community Clinics -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">local_hospital</span>
        <span>Community Clinics</span>
      </div>
      <div class="phone-number-grid">
        <div><b>CHC</b></div><div class="copy-box copy-box-small" data-message="801-693-7900">801-693-7900</div>
        <div><b>FHC</b></div><div class="copy-box copy-box-small" data-message="801-213-3200">801-213-3200</div>
        <div><b>GWC</b></div><div class="copy-box copy-box-small" data-message="801-213-9400">801-213-9400</div>
        <div><b>MHC</b></div><div class="copy-box copy-box-small" data-message="801-581-8000">801-581-8000</div>
        <div><b>PWC</b></div><div class="copy-box copy-box-small" data-message="801-234-8600">801-234-8600</div>
        <div><b>RSC</b></div><div class="copy-box copy-box-small" data-message="435-658-9200">435-658-9200</div>
        <div><b>RWC</b></div><div class="copy-box copy-box-small" data-message="801-213-9900">801-213-9900</div>
        <div><b>SJHC</b></div><div class="copy-box copy-box-small" data-message="801-213-4500">801-213-4500</div>
        <div><b>SBC</b></div><div class="copy-box copy-box-small" data-message="435-843-3000">435-843-3000</div>
        <div><b>SHC</b></div><div class="copy-box copy-box-small" data-message="801-581-2000">801-581-2000</div>
        <div><b>WRC</b></div><div class="copy-box copy-box-small" data-message="801-213-9200">801-213-9200</div>
      </div>
    </div>

    <!-- Gender Health -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">wc</span>
        <span>Gender Health</span>
      </div>
      <div class="phone-number-grid">
        <div><b>Women's Health</b></div><div class="copy-box copy-box-small" data-message="801-213-2995">801-213-2995</div>
        <div><b>Men's Health/Uro</b></div><div class="copy-box copy-box-small" data-message="801-213-2700">801-213-2700</div>
      </div>
    </div>

    <!-- Moran -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">visibility</span>
        <span>Moran</span>
      </div>
      <div class="phone-number-grid">
        <div><b>JMEC</b></div><div class="copy-box copy-box-small" data-message="801-581-2352">801-581-2352</div>
        <div><b>Midvalley</b></div><div class="copy-box copy-box-small" data-message="801-585-3937">801-585-3937</div>
        <div><b>Neuro-Ophthalmology</b></div><div class="copy-box copy-box-small" data-message="801-585-6540">801-585-6540</div>
      </div>
    </div>

    <!-- Orthopedics -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">orthopedics</span>
        <span>Orthopedics</span>
      </div>
      <div class="phone-number-grid">
        <div><b>SHC Rehab</b></div><div class="copy-box copy-box-small" data-message="801-581-2221">801-581-2221</div>
        <div><b>UOC</b></div><div class="copy-box copy-box-small" data-message="801-587-7109">801-587-7109</div>
        <div><b>UOC PT</b></div><div class="copy-box copy-box-small" data-message="801-587-7005">801-587-7005</div>
      </div>
    </div>

    <!-- Specialty -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">star</span>
        <span>Specialty</span>
      </div>
      <div class="phone-number-grid">
        <div><b>CNC Behavioral</b></div><div class="copy-box copy-box-small" data-message="801-585-1212">801-585-1212</div>
        <div><b>CNC Neurology</b></div><div class="copy-box copy-box-small" data-message="801-585-7575">801-585-7575</div>
        <div><b>CVC</b></div><div class="copy-box copy-box-small" data-message="801-585-7676">801-585-7676</div>
        <div><b>Echo/Vascular</b></div><div class="copy-box copy-box-small" data-message="801-585-2905">801-585-2905</div>
        <div><b>General Surgery</b></div><div class="copy-box copy-box-small" data-message="801-585-1618">801-585-1618</div>
        <div><b>Midvalley Derm</b></div><div class="copy-box copy-box-small" data-message="801-581-2955">801-581-2955</div>
        <div><b>Organ Transplant</b></div><div class="copy-box copy-box-small" data-message="801-581-6795">801-581-6795</div>
        <div><b>Plastics</b></div><div class="copy-box copy-box-small" data-message="801-581-7719">801-581-7719</div>
        <div><b>SWC</b></div><div class="copy-box copy-box-small" data-message="801-581-2016">801-581-2016</div>
        <div><b>UDEC</b></div><div class="copy-box copy-box-small" data-message="801-581-7761">801-581-7761</div>
        <div><b>UH Clinical Nutrition GI</b></div><div class="copy-box copy-box-small" data-message="801-213-8284">801-213-8284</div>
      </div>
    </div>

    <!-- Primary Care -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">family_restroom</span>
        <span>Primary Care</span>
      </div>
      <div class="phone-number-grid">
        <div><b>UH Peds</b></div><div class="copy-box copy-box-small" data-message="801-581-2205">801-581-2205</div>
      </div>
    </div>

    <!-- Miscellaneous -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">more_horiz</span>
        <span>Miscellaneous</span>
      </div>
      <div class="phone-number-grid">
        <div><b>ARUP Clinic</b></div><div class="copy-box copy-box-small" data-message="801-584-5144">801-584-5144</div>
        <div><b>Covid Hotline</b></div><div class="copy-box copy-box-small" data-message="801-587-0712">801-587-0712</div>
        <div><b>Dental</b></div><div class="copy-box copy-box-small" data-message="801-587-6453">801-587-6453</div>
        <div><b>GI/ENDO/Hepatology</b></div><div class="copy-box copy-box-small" data-message="801-213-9797">801-213-9797</div>
        <div><b>NRH Outpatient</b></div><div class="copy-box copy-box-small" data-message="801-581-2267">801-581-2267</div>
        <div><b>South Main</b></div><div class="copy-box copy-box-small" data-message="801-587-2525">801-587-2525</div>
      </div>
    </div>

    <!-- Interpreter Instructions -->
    <div class="phone-section-card">
      <div class="phone-section-header">
        <span class="material-symbols-outlined phone-section-icon">translate</span>
        <span>Interpreter Instructions</span>
      </div>
      <div class="interpreter-section">
        <b>SPANISH:</b>
        <ol>
          <li>CALL <div class="copy-box copy-box-small" data-message="4-4443">4-4443</div></li>
          <li>MOVE TO STEP 2 BELOW - IF PROMPTED</li>
        </ol>
        <b>FOR ALL OTHER LANGUAGES:</b>
        <ol>
          <li>CALL <div class="copy-box copy-box-small" data-message="801-512-0938">801-512-0938</div></li>
          <li>
            STEP 2:
            <ul>
              <li>Press 1 for <b>Spanish</b></li>
              <li>Press 2 for <b>Arabic</b></li>
              <li>Press 3 for <b>Nepali</b></li>
              <li>Press 4 for <b>Somali</b></li>
              <li>Press 5 for <b>Farsi</b></li>
              <li>Press 6 for <b>Vietnamese</b></li>
              <li>Press 7 for <b>Russian</b></li>
              <li>Press 8 for <b>Mandarin</b></li>
              <li>Press 9 for <b>all other languages</b></li>
            </ul>
          </li>
          <li>Provide Dept Code: <strong>10748</strong></li>
          <li>Provide Dept Phone Number: <strong>801-213-4610</strong></li>
        </ol>
      </div>
    </div>
  </div>
</div>
	
<div id="dotPhrasesModal" class="modal">
  <div class="modal-content">
    <div class="modal-actions">
      <button type="button" class="modal-close-btn" onclick="closeModal('dotPhrasesModal')">
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>
    <div class="mdc-dialog__container">
      <div class="mdc-card dotphrases-modal-foreground" style="padding: 24px; max-width: 900px; margin: 24px auto;">
        <h2 class="mdc-typography--headline6" style="text-align: center; margin-bottom: 12px;">
          <u>Dot Phrase Reference Tab</u>
        </h2>

    <div class="mdc-card info" style="margin-bottom: 24px; display: flex; align-items: flex-start; background: #e3f2fd; padding: 16px; border-radius: 8px;">
      <span class="material-symbols-outlined" style="font-size: 24px; color: #1976d2; margin-right: 8px;">info</span>
      <span>
        For the most up-to-date info on Outbound Dot Phrases, visit:<br>
        <a href="https://uofu.service-now.com/kbcn?sys_kb_id=6546a8cd472dea10d3d05a5c346d437d&id=uu_kb_article_view&sysparm_rank=10" style="color: #1976d2; text-decoration: underline;">
          Dot Phrases Outbound - Care Navigation Outbound - KB0021854
        </a>
      </span>
    </div>

    <div style="overflow-x: auto;">
      <table class="mdc-data-table__table" style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr style="background: #f5f5f5;">
            <th class="mdc-typography--subtitle2" style="padding: 12px; text-align: left;">DOT PHRASE</th>
            <th class="mdc-typography--subtitle2" style="padding: 12px; text-align: left;">PURPOSE</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 12px;">.PHLIST</td>
            <td style="padding: 12px;">Phone options for different service lines.</td>
          </tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Bumps &amp; Appt Changes</td>
          </tr>
          <tr><td style="padding: 12px;">.BUMPAPPTCHANGE</td><td style="padding: 12px;">Used to send Mychart message to a patient that appt has changed time/location/provider and SMS is not an option.</td></tr>
          <tr><td style="padding: 12px;">.BUMPTICKET</td><td style="padding: 12px;">Used when creating a MyChart ticket after cancelling same-day bumps</td></tr>
          <tr><td style="padding: 12px;">.BUMPTICKETSP</td><td style="padding: 12px;">Spanish Version of bumpticket</td></tr>
          <tr><td style="padding: 12px;">.CANCELRESCHEDULE</td><td style="padding: 12px;">Used when the appointment is canceled and a ticket is sent to help with rescheduling</td></tr>
          <tr><td style="padding: 12px;">.bad</td><td style="padding: 12px;">Used when advocates have tried to reach a patient with no answer regarding an appointment scheduled incorrectly online or through MyChart</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">PT CRM Request</td>
          </tr>
          <tr><td style="padding: 12px;">.ADDHM</td><td style="padding: 12px;">Health maintenance request appt already scheduled</td></tr>
          <tr><td style="padding: 12px;">.ADDMED</td><td style="padding: 12px;">Adds additional meds for refill request</td></tr>
          <tr><td style="padding: 12px;">.CRMREPLY</td><td style="padding: 12px;">Used for replying to CRM messages (Name/Sex Change or spelling errors, lodging, preferred pharmacy change, scheduling)</td></tr>
          <tr><td style="padding: 12px;">.CRMINS</td><td style="padding: 12px;">Used for Pt CRM messages for insurance updates</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Appointment Requests</td>
          </tr>
          <tr><td style="padding: 12px;">.APPTTICKETPROVIDER</td><td style="padding: 12px;">Used for replying to mychart request (providerleft, don't support, waitlist no appt, no template, ticket sent etc )</td></tr>
          <tr><td style="padding: 12px;">.APPTTICKETPROCESS</td><td style="padding: 12px;">Used for replying to mychart when needs further process for request (order, referral, labs, vaccine etc )</td></tr>
          <tr><td style="padding: 12px;">.APPTSCHEDULE</td><td style="padding: 12px;">Used when the patient has sent in a MyChart appointment request for an existing appointment for the same concerns/provider scheduled before the request was sent and the patient was added to the wait list</td></tr>
          <tr><td style="padding: 12px;">.MORANVISITINSTRUCTIONS</td><td style="padding: 12px;">Used to send instructions for moran visits. (adult, child, contact, retina, post op, Iritits/uvetitis)</td></tr>
          <tr><td style="padding: 12px;">.ORTHOVISITINSTRUCTIONS</td><td style="padding: 12px;">Used when sending tickets for ortho joint appts that requires paperwork. Mychart message explaining we will needed imaging brought to appt.</td></tr>
          <tr><td style="padding: 12px;">.TRIAGEMORAN</td><td style="padding: 12px;">Used when a mychart appointment request for Moran as triage symptoms</td></tr>
          <tr><td style="padding: 12px;">.TRTMT</td><td style="padding: 12px;">Used when a request for a specific medication or treatment (medication, treatment, consult for procedure, Spanish versions)</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Inpatient Discharge Scheduling</td>
          </tr>
          <tr><td style="padding: 12px;">.IPDISCHARGE</td><td style="padding: 12px;">Used discharge Mychart message when appointment scheduled</td></tr>
          <tr><td style="padding: 12px;">.IPNOCONTACT</td><td style="padding: 12px;">Used in CRM/Patient List to explain why we did not outreach to the patient to schedule apt with PCP after inpatient stay.</td></tr>
          <tr><td style="padding: 12px;">.IPPATIENTSCH</td><td style="padding: 12px;">Used to document inpatient discharge scheduling when the patient already had a f/u scheduled.</td></tr>
          <tr><td style="padding: 12px;">.IPSCHPL</td><td style="padding: 12px;">Used to document SMS text sent with scheduled appt for inpatient discharge scheduling.</td></tr>
          <tr><td style="padding: 12px;">.IPDISCHARGESP</td><td style="padding: 12px;">Used for discharge Mychart Message when appt scheduled Spanish version.</td></tr>
          <tr><td style="padding: 12px;">.IPCRM</td><td style="padding: 12px;">Used for CRM note updates for contacts</td></tr>
          <tr><td style="padding: 12px;">.bad</td><td style="padding: 12px;">Used when advocates have tried to reach a patient with no answer regarding an appointment scheduled incorrectly online or through MyChart</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Endoscopic Spine</td>
          </tr>
          <tr><td style="padding: 12px;">.ENDOIMAGE</td><td style="padding: 12px;">Used for Endospine image collection attempts</td></tr>
          <tr><td style="padding: 12px;">.ENDOIMAGEFAX</td><td style="padding: 12px;">Used for when a fax request for images needs to be sent</td></tr>
          <tr><td style="padding: 12px;">.ENDOIMAGEFOLLOWUP</td><td style="padding: 12px;">Used to document follow-up attempts for image collection</td></tr>
          <tr><td style="padding: 12px;">.ENDOTICKET</td><td style="padding: 12px;">Used for Mychart message when ticket sent for Endospine</td></tr>
          <tr><td style="padding: 12px;">.UTR</td><td style="padding: 12px;">Used when advocates have tried to reach a patient two times with no answer</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Well U HRA</td>
          </tr>
          <tr><td style="padding: 12px;">.HRAPCP</td><td style="padding: 12px;">Used for WELL U HRA mychart message</td></tr>
          <tr><td style="padding: 12px;">.bad</td><td style="padding: 12px;">Used when advocates have tried to reach a patient with no answer regarding an appointment scheduled incorrectly online or through MyChart</td></tr>
          <tr><td style="padding: 12px;">.UTR</td><td style="padding: 12px;">Used when advocates have tried to reach a patient two times with no answer</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Non Compliant Kidney</td>
          </tr>
          <tr><td style="padding: 12px;">.NONCOMPLIANTCRM</td><td style="padding: 12px;">Used to document contacts regarding communication for Non Compliant Kidney</td></tr>
          <tr><td style="padding: 12px;">.NONCOMPLIANTTICKET</td><td style="padding: 12px;">Used to send Mychart message for Non Compliant Kidney explaining ticket was sent to scheduel</td></tr>
          <tr><td style="padding: 12px;">.NONCOMPLIAANTOOS</td><td style="padding: 12px;">Used for Kidney Non compliant for out of state patients under 1 year post transplant</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">New American Scheduling</td>
          </tr>
          <tr><td style="padding: 12px;">.NEWAMERICANREQ</td><td style="padding: 12px;">Used to document in CRM work done for New American Scheduling.</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Ortho Web Requests</td>
          </tr>
          <tr><td style="padding: 12px;">.PMREMAIL</td><td style="padding: 12px;">Used to document web requests for Ortho &amp; contacts made</td></tr>
          <tr><td style="padding: 12px;">.bad</td><td style="padding: 12px;">Used when advocates have tried to reach a patient with no answer regarding an appointment scheduled incorrectly online or through MyChart</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Prescription Request</td>
          </tr>
          <tr><td style="padding: 12px;">.RXLVM</td><td style="padding: 12px;">Used for when VM left for rx request an appointment needs to be scheduled.</td></tr>
          <tr><td style="padding: 12px;">.RXREQUEST</td><td style="padding: 12px;">Used for when RX refill requires an appointment and we have sent a scheduling ticket.<br>Used for when RX refill requires an appointment for services we don't support to have them call to schedule.</td></tr>
          <tr><td style="padding: 12px;">.bad</td><td style="padding: 12px;">Used when advocates have tried to reach a patient with no answer regarding an appointment scheduled incorrectly online or through MyChart</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Waitlist</td>
          </tr>
          <tr><td style="padding: 12px;">.PTWAITLISTOFFER</td><td style="padding: 12px;">Used to send mychart message to offer a sooner appt</td></tr>
          <tr><td style="padding: 12px;">.PTDAILY</td><td style="padding: 12px;">Used to document work done &amp; instructions on SJHC PT waitlist</td></tr>
          <tr><td style="padding: 12px;">.PTWLREPLY</td><td style="padding: 12px;">Used to document SJHC PT when the patient confirms the appointment.</td></tr>
          <tr><td style="padding: 12px;">.WLTICKET</td><td style="padding: 12px;">Used for waitlist ticket</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">SSIR</td>
          </tr>
          <tr><td style="padding: 12px;">.SSIRADDINFO</td><td style="padding: 12px;">Used for a SSIR when additional information or action is needed from the patient.</td></tr>
          <tr><td style="padding: 12px;">.SSIRINFORM</td><td style="padding: 12px;">Used when sending patient Mychart message related to SSIR to inform patient but that doesn't require action on their part. (referral needed, referral needs review, complete test/labs before appt, 2 appts same concern, TOC, no license for state, misc. )</td></tr>
          <tr><td style="padding: 12px;">.bad</td><td style="padding: 12px;">Used when advocates have tried to reach a patient with no answer regarding an appointment scheduled incorrectly online or through MyChart</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">Registration</td>
          </tr>
          <tr><td style="padding: 12px;">.WSVTRESIDENTDEFERRAL</td><td style="padding: 12px;">Used when deferring an appt on Web Shceuled VT WQ due to reg missing attending</td></tr>
          <tr><td style="padding: 12px;">.REG</td><td style="padding: 12px;">Used for when we need to update registration on an appointment</td></tr>
          <tr>
            <td colspan="2" style="background: #e3f2fd; font-weight: 500; padding: 12px; color: #1976d2;">MAT Emails</td>
          </tr>
          <tr><td style="padding: 12px;">.MATCOTIVITIEMAIL</td><td style="padding: 12px;">Used for MAT</td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
</div>
</div>
	  
<script>
document.addEventListener('DOMContentLoaded', () => {
  // Sticky Notes Logic
  const stickyNote = document.getElementById('stickyNote');

  if (stickyNote) {
    const savedNote = localStorage.getItem('stickyNote');
    if (savedNote) {
      stickyNote.value = savedNote;
    }

    stickyNote.addEventListener('input', () => {
      localStorage.setItem('stickyNote', stickyNote.value);
    });
  }

  // To-Do List Logic
  const todoList = document.getElementById('todoList');
  const todoInput = document.querySelector('.todo-input');

  console.log('todoList element:', todoList); // Debugging
  console.log('todoInput element:', todoInput); // Debugging

  if (todoList && todoInput) {
    function saveToDoList() {
      const tasks = Array.from(todoList.children)
        .filter((item) => item.querySelector('.todo-list-item')) // Ignore input field
        .map((item) => {
          const textSpan = item.querySelector('.todo-list-item');
          return {
            text: textSpan ? textSpan.innerText : '',
            completed: item.classList.contains('completed'),
          };
        });
      console.log('Tasks being saved:', tasks); // Debugging
      localStorage.setItem('todoList', JSON.stringify(tasks));
    }

    const savedToDoList = JSON.parse(localStorage.getItem('todoList'));
    if (savedToDoList) {
      savedToDoList.forEach((task) => {
        const listItem = document.createElement('li');
        if (task.completed) {
          listItem.classList.add('completed');
        }
        listItem.innerHTML = `
          <span class="todo-list-item">${task.text}</span>
          <button class="todo-delete">❌</button>
        `;
        todoList.appendChild(listItem);
      });
    }

    todoInput.addEventListener('keypress', (event) => {
      console.log('Keypress detected:', event.key); // Debugging
      if (event.key === 'Enter') {
        const newTaskText = event.target.value.trim();
        console.log('New task text:', newTaskText); // Debugging
        if (!newTaskText) {
          alert('Task cannot be empty.');
          return;
        }
        const listItem = document.createElement('li');
        listItem.innerHTML = `
          <span class="todo-list-item">${newTaskText}</span>
          <button class="todo-delete">❌</button>
        `;
        todoList.appendChild(listItem);
        console.log('Task added to todoList:', listItem); // Debugging
        event.target.value = ''; // Clear the input field
        saveToDoList();
      }
    });

    todoList.addEventListener('click', (event) => {
      if (event.target.classList.contains('todo-delete')) {
        const listItem = event.target.parentElement;
        todoList.removeChild(listItem);
        saveToDoList();
      }
      if (event.target.classList.contains('todo-list-item')) {
        event.target.classList.toggle('completed');
        saveToDoList();
      }
    });
  }
});

// Modal Logic
function trapFocus(modal) {
  const focusableElements = modal.querySelectorAll(
    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
  );
  const firstFocusable = focusableElements[0];
  const lastFocusable = focusableElements[focusableElements.length - 1];

  modal.addEventListener('keydown', (e) => {
    if (e.key === 'Tab') {
      if (e.shiftKey) {
        // Shift + Tab
        if (document.activeElement === firstFocusable) {
          e.preventDefault();
          lastFocusable.focus();
        }
      } else {
        // Tab
        if (document.activeElement === lastFocusable) {
          e.preventDefault();
          firstFocusable.focus();
        }
      }
    }
  });
}

function openModal(modalId, color) {
  const modal = document.getElementById(modalId);
  if (!modal) return;
  const modalContent = modal.querySelector('.modal-content');
  if (modalContent) {
    modal.style.display = 'block';
    modal.setAttribute('aria-hidden', 'false');
    modalContent.style.backgroundColor = color;
    // Remove and add 'open' class to trigger transition
    modal.classList.remove('open');
    void modal.offsetWidth; // Force reflow
    modal.classList.add('open');
  }
}
function closeModal(modalId) {
  const modal = document.getElementById(modalId);
  if (!modal) return;
  modal.classList.remove('open');
  setTimeout(() => {
    modal.style.display = 'none';
    modal.setAttribute('aria-hidden', 'true');
  }, 500); // match your transition time
}
</script>

<br>
<br>


<div class="squircle-background">

<h1 id="Custom Buttons"> </h1>
<h1>Custom Buttons</h1>

<div class="danger">
<span class="material-symbols-outlined" style="font-size: 20px; color: red">Warning</span> Clearing your browser's cache will delete all your custom buttons! Please be sure to export your folders/custom buttons before clearing your browser's cache!
</div>

<!-- Modal triggers -->
<div class="actions-bar">
  <div style="margin: 1px 1;">
    <button id="openAddButtonModal" title="Add Button">
      <span class="material-symbols-outlined" style="font-size: 18px;">variable_add</span>
    </button>
    <button id="openAddFolderModal" title="Add Folder">
      <span class="material-symbols-outlined" style="font-size: 18px;">create_new_folder</span>
    </button>
    <button id="exportFolders" title="Export Folders/Buttons">
      <span class="material-symbols-outlined" style="font-size: 18px;">download</span>
    </button>
    <button id="importFolders" title="Import Folders/Buttons">
      <span class="material-symbols-outlined" style="font-size: 18px;">upload</span>
    </button>
    <input type="file" id="importFileInput" accept="application/json" style="display:none" />
  </div>
</div>

<!-- Hidden legacy form for compatibility (used for dropdown only) -->
<form id="addButtonForm" style="display:none">
  <input type="text" id="buttonText" placeholder="Button Label (optional)">
  <textarea id="buttonContent" placeholder="Button Content" ></textarea>
  
  <div>
<b>Color:</b>
    <select id="colorDropdown" required>
      <option value="#2196F3">Material Blue (Default)</option>
      <option value="red">Red</option>
      <option value="orange">Orange</option>
      <option value="yellow">Yellow</option>
      <option value="green">Green</option>
      <option value="blue">Blue</option>
      <option value="purple">Purple</option>
      <option value="gray">Gray</option>
      <option value="chartreuse">Chartreuse</option>
      <option value="cornflowerblue">CornflowerBlue</option>
      <option value="goldenrod">GoldenRod</option>
      <option value="orchid">Orchid</option>
      <option value="salmon">Salmon</option>
    </select>
  </div>
<div>
  <b>Folder:</b>
  <select id="addButtonFolderSelect" required></select>
</div>
<br>

<button type="submit"><span class="material-symbols-outlined" style="font-size: 18px;">variable_add</span> Add Button</button>
</form>

<div id="buttonsContainer"></div>
<div id="foldersContainer"></div>



</div>

<div class="squircle-background">

<h1>Initiatives:</h1>

<div class="squircle-foreground">
<h2 id="PT Wait List"><span class="material-symbols-outlined" style="color: black; font-size: 25px;">physical_therapy</span> PT Wait List</h2>
<div class="info">
<span class="material-symbols-outlined" style="font-size: 20px; color: blue">info</span><b> See Also: SMS: </b><a href="#SMS PT Wait List">PT Wait List</a>
</div>
<div class="squircle-foreground">
<h3><u>Offer Builder:</u></h3>


<b><span class="material-symbols-outlined" style="font-size: 18px; color: green;">event_repeat</span> Start here for reschedule appointment offer:</b>

<form id="messageForm">

    <div class="form-group">
      <label for="existingDate">1. Existing Date:</label>
      <input type="date" id="existingDate">
    </div>
    <div class="form-group">
      <label for="existingTime">2. Existing Time:</label>
      <input type="time" id="existingTime">
    </div>

  <label for="newProviderName">3. New Provider Name (if applicable):</label>
  <select id="newProviderName">
          <option value="">-- Select Provider --</option>
            <option value="Beadles, OT, Sydney">Beadles, Sydney</option>
            <option value="Beck, OT, Lauren">Beck, Lauren</option>
            <option value="Bennion, PT, David">Bennion, David</option>
            <option value="Berke, PT, Matthew">Berke, Matthew</option>
            <option value="Bildsten, SLP, Sarah">Bildsten, Sarah</option>
            <option value="Birely, PT, Alex">Birely, Alex</option>
            <option value="Black-Bain, DPT, Kristen">Black-Bain, Kristen</option>
            <option value="Boynton, PT, McKail">Boynton, McKail</option>
            <option value="Brown, OT, Tanita">Brown, Tanita</option>
            <option value="Call, DPT, Christopher">Call, Christopher</option>
            <option value="Corwin, PT, Andrea">Corwin, Andrea</option>
            <option value="Covey, PT, Conner">Covey, Conner</option>
            <option value="Culp, PT, Megan">Culp, Megan</option>
            <option value="Erickson, SLP, Olivia">Erickson, Olivia</option>
            <option value="Ferguson, DPT, Natalie">Ferguson, Natalie</option>
            <option value="Gifford, SLP, Taylor">Gifford, Taylor</option>
            <option value="Goettsche, PTA, Hallie">Goettsche, Hallie</option>
            <option value="Graddy, PT, Emma">Graddy, Emma</option>
            <option value="Hernandez, DPT, Kristina">Hernandez, Kristina</option>
           <option value="Herzog, DPT, Philip">Herzog, Philip</option>
           <option value="Holmes, OT, Vanessa">Holmes, Vanessa</option>
            <option value="Hudson, PT, Bradley">Hudson, Bradley</option>
            <option value="James, PT, Daniel">James, Daniel</option>
            <option value="Jensen, SLP, Brayden">Jensen, Brayden</option>
            <option value="Jamieson, SLP, Amy">Jamieson, Amy</option>
            <option value="Junk, PT, Elizabeth">Junk, Elizabeth</option>
            <option value="Khong, DPT, Taryn">Khong, Taryn</option>
           <option value="Kielgas, DPT, Brady">Kielgas, Brady</option>
           <option value="Krypel, PT, Karoleena">Krypel, Karoleena</option>
            <option value="Lunn, PT, Rebecca">Lunn, Rebecca</option>
            <option value="Lutz, DPT, Jordan">Lutz, Jordan</option>
            <option value="Lyman, DPT, Brooke">Lyman, Brooke</option>
            <option value="McCreedy, PT, Mary">McCreedy, Mary</option>
            <option value="Miller, DPT, Jason">Miller, Jason</option>
            <option value="Moyer, DPT, Cara">Moyer, Cara</option>
            <option value="Muhn, PT, Peter">Muhn, Peter</option>
            <option value="Mullen, DPT, Christina">Mullen, Christina</option>
            <option value="Nixon, OT, Neesha">Nixon, Neesha</option>
            <option value="O'Neil, DPT, Jacqueline">O'Neil, Jacqueline</option>
            <option value="Pohlman, OT, Brooke">Pohlman, Brooke</option>
            <option value="Powers, DPT, Clayton">Powers, Clayton</option>
            <option value="Ratliff, PT, Anna">Ratliff, Anna</option>
            <option value="Reich, DPT, Todd">Reich, Todd</option>
           <option value="Reierson, PT, Karl">Reierson, Karl</option>
            <option value="Rodgers, OT, Claire">Rodgers, Claire</option>
            <option value="Romero, PT, Julian">Romero, Julian</option>
            <option value="Salais Duarte, PT, Luis">Salais Duarte, Luis</option>
            <option value="Sauter, PT, Kendall">Sauter, Kendall</option>
            <option value="Savarise, DPT, Yvonne">Savarise, Yvonne</option>
           <option value="Schweitzer, SLP, Lisa">Schweitzer, Lisa</option>
           <option value="Schweitzer-Harper, SLP, Taylor">Schweitzer-Harper, Taylor</option>
           <option value="Shepherd, DPT, Collin">Shepherd, Collin</option>
            <option value="Sinner, DPT, Ryan">Sinner, Ryan</option>
            <option value="Stanislaw, PT, Abigail">Stanislaw, Abigail</option>
            <option value="Stevenson, PTA, Natali">Stevenson, Natali</option>
            <option value="Sharpe, PT, Channing">Sharpe, Channing</option>
            <option value="Taylor, PT, Imani">Taylor, Imani</option>
            <option value="Thompson, DPT, Spencer">Thompson, Spencer</option>
            <option value="Tucker, DPT, Kara">Tucker, Kara</option>
            <option value="Walburn, PT, Monica">Walburn, Monica</option>
            <option value="Williams, PT, Christina">Williams, Christina</option>
  </select>
<br>4. <u>Continue to Step 5.</u></br>
<br><b><span class="material-symbols-outlined" style="font-size: 20px; color: green;">calendar_add_on</span> Start here for additional appointment offer:</b></br>
    <div class="form-group">
      <label for="patientName">5. Patient Name:</label>
      <input type="text" id="patientName" style="max-width: 100px;">
    </div>
    <div class="form-group">
      <label for="existingProviderName">6. Provider Name:</label>
      <select id="existingProviderName">
        <option value="">-- Select Provider --</option>
            <option value="Beadles, OT, Sydney">Beadles, Sydney</option>
            <option value="Beck, OT, Lauren">Beck, Lauren</option>
            <option value="Bennion, PT, David">Bennion, David</option>
            <option value="Berke, PT, Matthew">Berke, Matthew</option>
            <option value="Bildsten, SLP, Sarah">Bildsten, Sarah</option>
            <option value="Birely, PT, Alex">Birely, Alex</option>
            <option value="Black-Bain, DPT, Kristen">Black-Bain, Kristen</option>
            <option value="Boynton, PT, McKail">Boynton, McKail</option>
            <option value="Brown, OT, Tanita">Brown, Tanita</option>
            <option value="Call, DPT, Christopher">Call, Christopher</option>
            <option value="Corwin, PT, Andrea">Corwin, Andrea</option>
            <option value="Covey, PT, Conner">Covey, Conner</option>
            <option value="Culp, PT, Megan">Culp, Megan</option>
            <option value="Erickson, SLP, Olivia">Erickson, Olivia</option>
            <option value="Ferguson, DPT, Natalie">Ferguson, Natalie</option>
            <option value="Gifford, SLP, Taylor">Gifford, Taylor</option>
            <option value="Goettsche, PTA, Hallie">Goettsche, Hallie</option>
            <option value="Graddy, PT, Emma">Graddy, Emma</option>
            <option value="Hernandez, DPT, Kristina">Hernandez, Kristina</option>
           <option value="Herzog, DPT, Philip">Herzog, Philip</option>
           <option value="Holmes, OT, Vanessa">Holmes, Vanessa</option>
            <option value="Hudson, PT, Bradley">Hudson, Bradley</option>
            <option value="James, PT, Daniel">James, Daniel</option>
            <option value="Jensen, SLP, Brayden">Jensen, Brayden</option>
            <option value="Jamieson, SLP, Amy">Jamieson, Amy</option>
            <option value="Junk, PT, Elizabeth">Junk, Elizabeth</option>
            <option value="Khong, DPT, Taryn">Khong, Taryn</option>
           <option value="Kielgas, DPT, Brady">Kielgas, Brady</option>
           <option value="Krypel, PT, Karoleena">Krypel, Karoleena</option>
            <option value="Lunn, PT, Rebecca">Lunn, Rebecca</option>
            <option value="Lutz, DPT, Jordan">Lutz, Jordan</option>
            <option value="Lyman, DPT, Brooke">Lyman, Brooke</option>
            <option value="McCreedy, PT, Mary">McCreedy, Mary</option>
            <option value="Miller, DPT, Jason">Miller, Jason</option>
            <option value="Moyer, DPT, Cara">Moyer, Cara</option>
            <option value="Muhn, PT, Peter">Muhn, Peter</option>
            <option value="Mullen, DPT, Christina">Mullen, Christina</option>
            <option value="Nixon, OT, Neesha">Nixon, Neesha</option>
            <option value="O'Neil, DPT, Jacqueline">O'Neil, Jacqueline</option>
            <option value="Pohlman, OT, Brooke">Pohlman, Brooke</option>
            <option value="Powers, DPT, Clayton">Powers, Clayton</option>
            <option value="Ratliff, PT, Anna">Ratliff, Anna</option>
            <option value="Reich, DPT, Todd">Reich, Todd</option>
           <option value="Reierson, PT, Karl">Reierson, Karl</option>
            <option value="Rodgers, OT, Claire">Rodgers, Claire</option>
            <option value="Romero, PT, Julian">Romero, Julian</option>
            <option value="Salais Duarte, PT, Luis">Salais Duarte, Luis</option>
            <option value="Sauter, PT, Kendall">Sauter, Kendall</option>
            <option value="Savarise, DPT, Yvonne">Savarise, Yvonne</option>
           <option value="Schweitzer, SLP, Lisa">Schweitzer, Lisa</option>
           <option value="Schweitzer-Harper, SLP, Taylor">Schweitzer-Harper, Taylor</option>
           <option value="Shepherd, DPT, Collin">Shepherd, Collin</option>
            <option value="Sinner, DPT, Ryan">Sinner, Ryan</option>
            <option value="Stanislaw, PT, Abigail">Stanislaw, Abigail</option>
            <option value="Stevenson, PTA, Natali">Stevenson, Natali</option>
            <option value="Sharpe, PT, Channing">Sharpe, Channing</option>
            <option value="Taylor, PT, Imani">Taylor, Imani</option>
            <option value="Thompson, DPT, Spencer">Thompson, Spencer</option>
            <option value="Tucker, DPT, Kara">Tucker, Kara</option>
            <option value="Walburn, PT, Monica">Walburn, Monica</option>
            <option value="Williams, PT, Christina">Williams, Christina</option>
      </select>
    </div>
	</form>
<div class="form-group">
    <div class="form-group">
      <label for="newDate">7. New Date:</label>
      <input type="date" id="newDate">
      <button type="button" id="setTodayButton">Today</button>
    </div>
    <div class="form-group">
      <label for="newTime">8. New Time:</label>
      <input type="time" id="newTime">
    </div>


<label>9. Choose Format:</label>
<br>
<div class="sub-label">SMS Options:</div>
 <button type="button" id="btnRescheduleSMS">Reschedule</button>
 <button type="button" id="btnAdditionalSMS">Additional Visit</button>
 <br>
 <button type="button" id="btnRescheduleSpanishSMS">Reschedule (Spanish)</button>
 <button type="button" id="btnAdditionalSpanishSMS">Additional Visit (Spanish)</button>
</div>
<div class="sub-label">MyChart Message Options:</div>
 <button type="button" id="btnRescheduleMyChart">Reschedule</button>
 <button type="button" id="btnAdditionalMyChart">Additional Visit</button>
<br>
 <button type="button" id="btnRescheduleSpanishMyChart">Reschedule (Spanish)</button>
 <button type="button" id="btnAdditionalSpanishMyChart">Additional Visit (Spanish)</button>
<br>
<br>
<label>10. Click to Copy:</label>
<br>
  <div class="copy-box" id="copyBox">
Please fill out above form to generate the SMS you will send to the patient.
  </div>
  <label>11. Add to CRM</label>
<br>
<div class="copy-box" id="summaryBox">
  with [PROVIDER] for [NEW DATE] at [NEW TIME]
</div>
<br>
<button type="button" id="clearFormButton" style="background:#f44336;color:white;margin:8px 0;">
  Clear Form
</button>
<!--PT WL Initiative Script-->
<script>
document.addEventListener('DOMContentLoaded', () => {
  // Clear Form button
  document.getElementById('clearFormButton').addEventListener('click', () => {
    document.getElementById('messageForm').reset();
    document.getElementById('patientName').value = '';
    document.getElementById('newDate').value = '';
    document.getElementById('newTime').value = '';
    document.getElementById('setTodayButton').blur();
    document.getElementById('summaryBox').textContent = 'with [PROVIDER] for [NEW DATE] at [NEW TIME]';
    document.getElementById('copyBox').textContent = 'Please fill out above form to generate the SMS you will send to the patient.';
  });

  // Set today's date
  const getTodayDate = () => {
    const today = new Date();
    const year = today.getFullYear();
    const month = String(today.getMonth() + 1).padStart(2, '0');
    const day = String(today.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
  };
  document.getElementById('setTodayButton').addEventListener('click', () => {
    const todayDate = getTodayDate();
    document.getElementById('newDate').value = todayDate;
    document.getElementById('newDate').dispatchEvent(new Event('input'));
  });

  // Format helpers
  const formatDate = (inputDate) => {
    if (!inputDate) return '[NEW DATE]';
    const [year, month, day] = inputDate.split('-');
    return `${month}/${day}`;
  };
  const formatTime = (inputTime) => {
    if (!inputTime) return '[NEW TIME]';
    let [hour, minute] = inputTime.split(':');
    hour = parseInt(hour, 10);
    const ampm = hour >= 12 ? 'PM' : 'AM';
    hour = hour % 12 || 12;
    return `${hour}:${minute} ${ampm}`;
  };

  // Get form values
  const getFields = () => {
    const existingProviderRaw = document.getElementById('existingProviderName').value || '[EXISTING PROVIDER NAME]';
    const newProviderRaw = document.getElementById('newProviderName').value;
    const formatProviderName = (providerRaw) => {
      if (providerRaw && providerRaw.includes(',')) {
        const parts = providerRaw.split(',').map(part => part.trim());
        if (parts.length === 3) {
          const [last, credential, first] = parts;
          return `${first} ${last}, ${credential}`;
        } else if (parts.length === 2) {
          const [last, first] = parts;
          return `${first} ${last}`;
        } else {
          return providerRaw;
        }
      } else if (providerRaw) {
        return providerRaw;
      }
      return '';
    };
    return {
      patientName: document.getElementById('patientName').value || '[PATIENT NAME]',
      existingDate: formatDate(document.getElementById('existingDate').value) || '[EXISTING DATE]',
      existingTime: formatTime(document.getElementById('existingTime').value) || '[EXISTING TIME]',
      existingProviderName: formatProviderName(existingProviderRaw),
      newDate: formatDate(document.getElementById('newDate').value),
      newTime: formatTime(document.getElementById('newTime').value),
      newProviderName: formatProviderName(newProviderRaw),
    };
  };

  // Update summary
  const updateSummaryBox = () => {
    const { newDate, newTime, newProviderName, existingProviderName } = getFields();
    const providerName = newProviderName || existingProviderName;
    document.getElementById('summaryBox').textContent = `with ${providerName} for ${newDate} at ${newTime}`;
  };
  const debounce = (func, delay) => {
    let timer;
    return (...args) => {
      clearTimeout(timer);
      timer = setTimeout(() => func(...args), delay);
    };
  };
  const debouncedUpdate = debounce(updateSummaryBox, 300);
  ['newDate', 'newTime', 'newProviderName', 'existingProviderName'].forEach(id => {
    document.getElementById(id).addEventListener('input', debouncedUpdate);
  });

  // Copy to clipboard
  document.getElementById('summaryBox').addEventListener('click', () => {
    const text = document.getElementById('summaryBox').textContent;
    navigator.clipboard.writeText(text).catch(err => { console.error('Failed to copy text:', err); });
  });
  const copyBox = document.getElementById('copyBox');
  copyBox.addEventListener('click', () => {
    const text = copyBox.textContent;
    navigator.clipboard.writeText(text).catch(err => {
      alert('Failed to copy text: ' + err);
    });
  });

  // SMS functions
  const generateOriginal = () => {
    const f = getFields();
    const newProviderText = f.newProviderName ? ` with ${f.newProviderName}` : '';
    const msg = `UofU Health: ${f.patientName}, an earlier visit is available:  
Existing visit: ${f.existingDate} at ${f.existingTime} with ${f.existingProviderName}  
New visit: ${f.newDate} at ${f.newTime}${newProviderText}  
This has been offered to multiple patients. Don't delay. Reply 1 to accept.`;
    copyBox.textContent = msg;
  };
  const generateAltEnglish = () => {
    const f = getFields();
    const msg = `UofU Health: ${f.patientName}, an additional visit is available:  
New visit: ${f.newDate} at ${f.newTime} with ${f.existingProviderName}  
This has been offered to multiple patients. Don't delay. Reply 1 to accept.`;
    copyBox.textContent = msg;
  };
  const generateSpanishEarlier = () => {
    const f = getFields();
    const newProviderText = f.newProviderName ? ` con ${f.newProviderName}` : '';
    const msg = `UofU Health: ${f.patientName}, una visita anterior está disponible:  
Visita existente: ${f.existingDate} a las ${f.existingTime} con ${f.existingProviderName}  
Nueva visita: ${f.newDate} a las ${f.newTime}${newProviderText}  
Esto se ha ofrecido a varios pacientes. No te demores. Responda 1 para aceptar.`;
    copyBox.textContent = msg;
  };
  const generateSpanishAdditional = () => {
    const f = getFields();
    const msg = `UofU Health: ${f.patientName}, hay una visita adicional disponible:  
Nueva visita: ${f.newDate} a las ${f.newTime} con ${f.existingProviderName}  
Esto se ha ofrecido a varios pacientes. No te demores. Responda 1 para aceptar.`;
    copyBox.textContent = msg;
  };

  // MyChart functions
  const generateMyChartReschedule = () => {
    const f = getFields();
	const newProviderText = f.newProviderName ? ` with ${f.newProviderName}` : '';
    const msg = `Hi ${f.patientName},

An earlier visit is available:  

Existing visit: ${f.existingDate} at ${f.existingTime} with ${f.existingProviderName}

New visit: ${f.newDate} at ${f.newTime}${newProviderText}

This has been offered to multiple patients. Don't delay. Reply to this message or call our team at 801-587-7005 to accept.`;
    copyBox.textContent = msg;
  };
  const generateMyChartAdditional = () => {
    const f = getFields();
    const msg = `Hi ${f.patientName},

An additional visit is available:  

New visit: ${f.newDate} at ${f.newTime} with ${f.existingProviderName}

This has been offered to multiple patients. Don't delay. Reply to this message or call our team at 801-587-7005 to accept.`;
    copyBox.textContent = msg;
  };
  const generateMyChartRescheduleSpanish = () => {
    const f = getFields();
	const newProviderText = f.newProviderName ? ` con ${f.newProviderName}` : '';
    const msg = `Hola ${f.patientName},

Una visita anterior está disponible:  

Visita existente: ${f.existingDate} a las ${f.existingTime} con ${f.existingProviderName}

Nueva visita: ${f.newDate} a las ${f.newTime}${newProviderText}

Esto se ha ofrecido a varios pacientes. No se demore. Responda a este mensaje o llame a nuestro equipo al 801-587-7005 para aceptar.`;
    copyBox.textContent = msg;
  };
  const generateMyChartAdditionalSpanish = () => {
    const f = getFields();
    const msg = `Hola ${f.patientName},

Hay una visita adicional disponible:  

Nueva visita: ${f.newDate} a las ${f.newTime} con ${f.existingProviderName}

Esto se ha ofrecido a varios pacientes. No se demore. Responda a este mensaje o llame a nuestro equipo al 801-587-7005 para aceptar.`;
    copyBox.textContent = msg;
  };

  // Attach event listeners to all buttons
  document.getElementById('btnRescheduleSMS').addEventListener('click', generateOriginal);
  document.getElementById('btnAdditionalSMS').addEventListener('click', generateAltEnglish);
  document.getElementById('btnRescheduleSpanishSMS').addEventListener('click', generateSpanishEarlier);
  document.getElementById('btnAdditionalSpanishSMS').addEventListener('click', generateSpanishAdditional);
  document.getElementById('btnRescheduleMyChart').addEventListener('click', generateMyChartReschedule);
  document.getElementById('btnAdditionalMyChart').addEventListener('click', generateMyChartAdditional);
  document.getElementById('btnRescheduleSpanishMyChart').addEventListener('click', generateMyChartRescheduleSpanish);
  document.getElementById('btnAdditionalSpanishMyChart').addEventListener('click', generateMyChartAdditionalSpanish);
});
</script>
<br>
<hr>

<b><span class="material-symbols-outlined" style="font-size: 18px; color: green;">event_busy</span> No appointment available:</b>

<div class="copy-box" data-message="No availability, [DATE]: [UID]">Copy to Wait List Message</div>

<br>

<div class="info">
<span class="material-symbols-outlined" style="font-size: 20px; color: blue">info</span> Note: To set your UID, go to <a href="#Settings">Settings</a>
</div>


</div>
</div>
</div>
</div>

<div class="squircle-background">
<h1 id="Email"><span class="material-symbols-outlined" style="color: black; font-size: 35px;">mail</span> Email</h1>

<div class="squircle-foreground">
<h3><span class="material-symbols-outlined" style="color: black; font-size: 25px;">contact_mail</span> Contacts:</h3>

<div class="copy-box" data-message="Mindee.Miller@hsc.utah.edu">Mindee Miller</div>
<div class="copy-box" data-message="Templates@hsc.utah.edu">Templates Team</div>

</div>
</div>


<div class="squircle-background">

<h1><span class="material-symbols-outlined" style="color: black; font-size: 35px;">chat</span> SMS</h1>

<div class="danger">
<span class="material-symbols-outlined" style="font-size: 20px; color: red">Warning</span> Text Messages to patients should NEVER include emojis, abbreviated phrasing, slang to derogatory comments. All communication must be to University standard. If none of the below responses fit for the interaction you're having, please consult Kim or Mindee before responding.
</div>

<div class="webtext">
<span class="material-symbols-outlined" style="font-size: 20px; color: purple">quick_phrases</span> Set WebText tool to UHealth General Number: 801-213-9500
</div>


<div class="squircle-foreground">
<h3 id="Bump Text SMS Messages"><span class="material-symbols-outlined" style="color: black; font-size: 25px;">ink_eraser</span><b> Bump Text SMS Messages:</b></h3>

<div class="copy-box" data-message="UofU Health: Your appt on @ needs to be rescheduled. We apologize for any inconvenience. Please call U of U Health 801-213-9500 to reschedule.">Future Manual Bump</div>
<div class="copy-box" data-message="UofU Health: Es necesario reprogramar su cita del @. Nos disculpamos por la inconveniencia. Por favor llame a U of U Health al 801-213-9500 para reprogramarla.">Future Manual Bump (Spanish)</div>
<div class="copy-box" data-message="UofU Health: (Name) your appt on (Date) has been canceled. Please contact us at 801-213-9500 to reschedule . We apologize for this inconvenience.">Canceled Appointment</div>
<div class="copy-box" data-message="UofU Health: (Name) la cita del (date) se canceló. Llámenos al 801-213-9500 para reprogramarla. Discúlpenos por la inconveniencia.">Canceled Appointment (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Your appt on @ has been cancelled and needs to be rescheduled. We apologize for any inconvenience. Please use the Mychart scheduling ticket we have sent you or call us at 801-213-9500 to reschedule.">Same day & Short Notice Bump (under 4 days)</div>
<div class="copy-box" data-message="UofU Health: Su cita en @ ha sido cancelada y necesita ser reprogramada. Pedimos disculpas por cualquier inconveniente. Utilice el boleto de programación de Mychart que le hemos enviado o llámenos al 801-213-9500 para reprogramar">Same day & Short Notice Bump (under 4 days) (Spanish)</div>
</div>

<div class="squircle-foreground">
<h3 id="Virtual Visit Change Texts"><span class="material-symbols-outlined" style="color: black; font-size: 25px;">video_chat</span><b> Virtual Visit Change Texts:</b></h3>

<div class="copy-box" data-message="UofU Health: Your appt today @ Time has changed to a video visit. Log onto MyChart.med.utah.edu for your appt. To reschedule, call 801-213-9500">MyChart Active (Appt Today)</div>
<div class="copy-box" data-message="UofU Health: Su cita de hoy @ Time ha cambiado a una visita por video. Inicie sesión en MyChart.med.utah.edu para su cita. Para reprogramar, llame al 801-213-9500">MyChart Active (Appt Today) (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Your appt on Date @ Time has changed to a video visit. Log onto MyChart.med.utah.edu for your appt. To reschedule, call 801-213-9500">MyChart Active  (Future Appt)</div>
<div class="copy-box" data-message="UofU Health: Su cita en Fecha @ Hora ha cambiado a una visita por video. Inicie sesión en MyChart.med.utah.edu para su cita. Para reprogramar, llame al 801-213-9500">MyChart Active  (Future Appt) (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Your appt today @ Time has changed to a video visit. You will receive a video link prior to your appt. To reschedule: 801-213-9500">Non-MyChart Active (Appt Today)</div>
<div class="copy-box" data-message="UofU Health: Su cita de hoy @ Time ha cambiado a una visita por video. Recibirá un enlace de video antes de su cita. Para reprogramar: 801-213-9500">Non-MyChart Active (Appt Today) (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Your appt on Date @ Time has changed to a video visit. You will receive a video link prior to your appt. To reschedule: 801-213-9500">Non-MyChart Active (Future Appt)</div>
<div class="copy-box" data-message="UofU Health: Su cita en Fecha @ Hora ha cambiado a una visita por video. Recibirá un enlace de video antes de su cita. Para reprogramar: 801-213-9500">Non-MyChart Active (Future Appt) (Spanish)</div>

</div>

<div class="squircle-foreground">

<h3 id="COVID InPatient Texts"><span class="material-symbols-outlined" style="color: black; font-size: 25px;">coronavirus</span><b> COVID InPatient Texts</b></h3>
<br>

<div class="copy-box" data-message="UofU Health: Attempting to schedule 2nd COVID vaccine, will you be in town anytime from 00/00 - 00/00? If not, contact local health dept for 2nd dose. Thank you!">COVID 2nd Dose Out Of State</div>
<div class="copy-box" data-message="UofU Health: Patient Name, 2nd COVID vaccines available via MyChart.med.utah.edu, or at vaccines.gov.">No Availability - Mychart Active</div>
<div class="copy-box" data-message="UofU Health: Patient Name, 2nd COVID vaccines available at vaccines.gov.">No Availability - Inactive Mychart</div>

</div>

<div class="squircle-foreground">

<h3 id="RX Texts"><span class="material-symbols-outlined" style="color: black; font-size: 25px;">medication</span><b> RX Texts:</b></h3>
<br>
<div class="webtext">
<span class="material-symbols-outlined" style="font-size: 20px; color: purple">quick_phrases</span> Set WebText tool to RX Refill: 801-213-5090</br>
</div>

<br><b>Denied:</b></br>

<div class="copy-box" data-message="UofU Health: Your refill request has been denied and requires an office appointment. Please CALL U of U Health to schedule 801-213-5090.">Denied - Office Appt</div>
<div class="copy-box" data-message="UofU Health: Negaron el resurtido que pidió y necesita hacer una cita. Llame U of U Health para programar la cita: 801-213-5090.">Denied - Office Appt (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Your refill request has been denied and requires lab work. Please CALL U of U Health to schedule 801-213-5090.">Denied - Lab</div>
<div class="copy-box" data-message="UofU Health: Negaron el resurtido que pidió y necesita análisis de laboratorio. Llame U of U Health para programar la cita: 801-213-5090.">Denied - Lab (Spanish)</div>

<b>Approved:</b>

<div class="copy-box" data-message="UofU Health: Your refill request has been fulfilled and sent to your preferred pharmacy. Please CALL U of U Health with any questions 801-213-5090.">Approved</div>
<div class="copy-box" data-message="UofU Health: Ya se envió a su farmacia de preferencia el resurtido que pidió. Llame a U of U Health si tiene preguntas: 801-213-5090.">Approved (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Your refill request has been fulfilled, but an office appointment is needed before next time. Please CALL U of U Health to schedule 8012135090.">Approved - Office Appt</div>
<div class="copy-box" data-message="UofU Health: Ya se envió el resurtido que pidió, pero necesita una consulta antes de adquirir más. Llame a U of U Health para programarla: 801-213-5090.">Approved - Office Appt (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Your refill request has been fulfilled, but labs are needed before next time. Please CALL U of U Health to schedule 801-213-5090.">Approved - Lab</div>
<div class="copy-box" data-message="UofU Health: Ya se envió el resurtido que pidió, pero se necesitan análisis de laboratorio antes de adquirir más. Llame a U of U Health para hacérselos: 801-213-5090.">Approved - Lab (Spanish)</div>

<b>Responses:</b>

<div class="copy-box" data-message="Thank You">Thank You</div>
<div class="copy-box" data-message="¡Muchas gracias!">Thank You (Spanish)</div>
<div class="copy-box" data-message="Thank You. May I call you to schedule this appointment?">Wants to Schedule</div>
<div class="copy-box" data-message="¡Muchas gracias! ¿Puedo llamarlo(a) para programar esta cita?">Wants to Schedule (Spanish)</div>
<div class="copy-box" data-message="We apologize for this inconvenience.">Apology</div>
<div class="copy-box" data-message="Discúlpenos por la inconveniencia.">Apology (Spanish)</div>

</div>

<div class="squircle-foreground">

<h3 id="Web Scheduled Visit Texts"><b>Web Scheduled Visit Texts</b></h3>

<div class="copy-box" data-message="UofUHealth: (NAME), more information is REQUIRED before your video visit on MM/DD. To continue via text, reply with the patient's last name and zip code. If preferred, you may call us at 801-213-9500 to complete required registration.">Template: WSV Reg - Text 1</div>
<div class="copy-box" data-message="Your response does not match what we have on file for this account. Please ensure that there are no typos and try again.">Demographics don't match</div>

<font color="Green"><b>Adult - MyChart Active</b></font>

<div class="copy-box" data-message="Thank you for verifying your account. I will now ask 3 additional questions to complete registration. Question 1 of 3: What is the patient's preferred language?">Identity Validated & Question 1</div>
<div class="copy-box" data-message="Question 2 of 3: Is the reason for this visit due to an accident or injury? Reply: YES or NO.">Question 2</div>
<div class="copy-box" data-message="Someone from our team will need to call you to discuss further. Expect a phone call shortly from 801-213-9500. Thank you.">Question 2 - Answer 1 (YES)</div>
<div class="copy-box" data-message="Question 3 of 3: We have communication aides for those with disabilities related to hearing, vision or speech. Is this support needed? Reply: YES or NO.">Question 3</div>
<div class="copy-box" data-message="What type of service will the patient need? Guide/Assistant, Note Taker/Scribe, Qualified Reader, Sign Language Interpreter">Question 3 - Answer 1 (YES)</div>
<div class="copy-box" data-message="Thank you. The video visit is confirmed for MM/YY at APPTTIME. Please contact your insurance to verify coverage for provider and facility. ?'s, call 801-213-9500. ">Final Message</div>

<font color="Gold"><b>Adult - MyChart InActive</b></font>

<div class="copy-box" data-message="Thank you for verifying your account. A MyChart account is required for this video visit. Can I text you an activation link so you can sign up? Reply: YES or NO">Identity Validated & Question 1</div>
<div class="copy-box" data-message="The MyChart invitation will come from 32359. I will now ask 3 additional questions to complete registration.">MyChart Activation - Answer (YES)</div>
<div class="copy-box" data-message="MyChart is required to complete the video visit. Would you like me to cancel this video visit or call you to schedule an in person visit? Reply CANCEL or CALL">MyChart Activation - Answer (NO)</div>
<div class="copy-box" data-message="The visit on 00/00 has been cancelled. You may call us at 801-213-9500 if you have further questions.">MyChart Activation - Answer (NO) - CANCEL</div>
<div class="copy-box" data-message="Question 1 of 3: What is the patient's preferred language?">Question 1</div>
<div class="copy-box" data-message="Question 2 of 3: Is the reason for this visit due to an accident or injury? Reply: YES or NO.">Question 2</div>
<div class="copy-box" data-message="Someone from our team will need to call you to discuss further. Expect a phone call shortly from 801-213-9500. Thank you.">Question 2 - Answer (YES)</div>
<div class="copy-box" data-message="Question 3 of 3: We have communication aides for those with disabilities related to hearing, vision or speech. Is this support needed? Reply: YES or NO.">Question 3</div>
<div class="copy-box" data-message="What type of service will the patient need? Guide/Assistant, Note Taker/Scribe, Qualified Reader, Sign Language Interpreter">Question 3 - Answer (YES)</div>
<div class="copy-box" data-message="Thank you. The video visit is confirmed for MM/YY at APPTTIME. Please contact your insurance to verify coverage for provider and facility. ?'s, call 801-213-9500. ">Final Message</div>

<font color="DarkSalmon"><b>Minor - MyChart Active</b></font>

<div class="copy-box" data-message="Thank you. I will now ask you a few questions in order to complete the appt registration. There will be 4 questions total. Question 1 of 4: What is the patient's preferred language?">Identity Validated & Question 1</div>
<div class="copy-box" data-message="Question 2 of 4: Is the reason for this visit due to an accident or injury? Reply: YES or NO.">Question 2</div>
<div class="copy-box" data-message="Someone from our team will need to call you to discuss further. Expect a phone call shortly from 801-213-9500. Thank you.">Question 2 - Answer (YES)</div>
<div class="copy-box" data-message="Question 3 of 4: We have communication aides for those with disabilities related to hearing, vision or speech. Is this support needed? Reply: YES or NO.">Question 3</div>
<div class="copy-box" data-message="What type of service will the patient need? Guide/Assistant, Note Taker/Scribe, Qualified Reader, Sign Language Interpreter">Question 3 - Answer (YES)</div>
<div class="copy-box" data-message="Question 4 of 4: We have (GUARNAME) listed as being financially responsible for the account. Can you confirm their address, employer name and employment status?">Question 4</div>
<div class="copy-box" data-message="Thank you. The video visit is confirmed for MM/YY at APPTTIME. Please contact your insurance to verify coverage for provider and facility. ?'s, call 801-213-9500.">Final Message</div>

<font color="CornflowerBlue"><b>Minor - MyChart InActive</b></font>

<div class="copy-box" data-message="Thank you. A MyChart account is required for this video visit. To activate, please call MyChart support at 801-213-5555. I will now ask you 4 questions in order to complete registration. Question 1 of 4: What is the patient's preferred language?">Identity Validated & MyChart Activation</div>
<div class="copy-box" data-message="Question 2 of 4: Is the reason for this visit due to an accident or injury? Reply: YES or NO.">Question 2</div>
<div class="copy-box" data-message="Someone from our team will need to call you to discuss further. Expect a phone call shortly from 801-213-9500. Thank you.">Question 2 - Answer (YES)</div>
<div class="copy-box" data-message="Question 3 of 4: We have communication aides for those with disabilities related to hearing, vision or speech. Is this support needed? Reply: YES or NO.">Question 3</div>
<div class="copy-box" data-message="What type of service will the patient need? Guide/Assistant, Note Taker/Scribe, Qualified Reader, Sign Language Interpreter">Question 3 - Answer (YES)</div>
<div class="copy-box" data-message="Question 4 of 4: We have (GUARNAME) listed as being financially responsible for the account. Can you confirm their address, employer name and employment status?">Question 4</div>
<div class="copy-box" data-message="Thank you. The video visit is confirmed for MM/YY at APPTTIME. Please contact your insurance to verify coverage for provider and facility. ?'s, call 801-213-9500.">Final Message</div>

<font color="MediumSlateBlue"><b>Return Patient</b></font>

<div class="copy-box" data-message="Thank you for verifying your account. I will now ask additional questions to complete registration.">Introduction</div>
<div class="copy-box" data-message="Is the reason for this visit due to an accident or injury? Reply: YES or NO.">Accident Related</div>
<div class="copy-box" data-message="Someone from our team will need to call you to discuss further. Expect a phone call shortly from 801-213-9500. Thank you.">Accident Related - Answer (YES)</div>
<div class="copy-box" data-message="Thank you. The video visit is confirmed for 00/00 at 0:00 AM/PM. Please verify insurance coverage for provider and facility. For questions, call 801-213-9500.">Final Message</div>

</div>

<div class="squircle-foreground">

<h3 id="Misc Texts and Responses"><b>Misc Texts and Responses:</b></h3>
<br><b>Misc</b></br>

<div class="copy-box" data-message="UofU Health: I'm sorry to hear this. We recommend downloading the SafeUT app to talk with one of our crisis counselors directly.">SafeUT Resource</div>
<div class="copy-box" data-message="UofU Health: Sentimos mucho escuchar lo que pasó. Le recomendamos descargar la aplicación SafeUT para hablar directamente con nuestros terapeutas especializados en crisis.">SafeUT Resource (Spanish)</div>
<div class="copy-box" data-message="UofU Health: We apologize, we’re unable to opt you out due to refills requiring a response.">Opt Out Text</div>
<div class="copy-box" data-message="UofU Health: Lo sentimos, pero no nos es posible cambiar las notificaciones que recibe para resurtir sus recetas, dado que es necesario que la farmacia reciba una respuesta de usted.">Opt Out Text (Spanish)</div>
<div class="copy-box" data-message="U of U Health: Your appt on @ XXX will be completed @ XXX, due to your providers location change. For ?'s CALL 801-213-9500.">Location Change</div>
<div class="copy-box" data-message="U of Utah Health: Su cita del XX será en ENTER HEALTH CENTER HERE, ya que su proveedor estará allí. ¿Preguntas? LLAME al 801-213-9500.">Location Change (Spanish)</div>
<div class="copy-box" data-message="U of U Health: Your appt on XX was moved to XX @ . For ?'s CALL 801-213-9500.">Time Change</div>
<div class="copy-box" data-message="U of U Health: Your appt on XXX  @  will be completed by a different provider, due to your provider not being available. For ?'s CALL 801-213-9500.">Provider Change</div>
<div class="copy-box" data-message="U of U Health: Su cita el día XX se hará con otro proveedor, porque su proveedor no está disponible. ¿Preguntas? LLAME al 801-213-9500.">Provider Change (Spanish)</div>
<div class="copy-box" data-message="U of U Health: Your appt on @ will be completed @ XXX, due to your providers location change. For ?'s CALL 801-213-9500.">Permanent Location Change</div>
<div class="copy-box" data-message="U of Utah Health: Su cita del XX será en INSERT HEALTH CENTER HERE, ya que su proveedor se trasladó allí. ¿Preguntas? LLAME al 801-213-9500.">Permanent Location Change (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Due to HIPAA regulations we are unable to assist via text message. For assistance please call us at 801-213-9500.">Generic Response</div>
<div class="copy-box" data-message="U of U Health: We have important questions regarding your appointment on Date, please call us back at ______. (dept/service #)">MAT/Covititi</div>

<b>Responses</b>

<div class="copy-box" data-message="Thank You.">Thank You</div>
<div class="copy-box" data-message="¡Muchas gracias!">Thank You (Spanish)</div>
<div class="copy-box" data-message="CORRECTION UofU Health: Please disregard previous text message. Apologies for the inconvenience">Correction</div>
<div class="copy-box" data-message="Thank You. May I call you to reschedule this appointment?">Wants to Reschedule</div>
<div class="copy-box" data-message="¡Muchas gracias! ¿Puedo llamarlo(a) para programar esta cita?">Wants to Reschedule (Spanish)</div>
<div class="copy-box" data-message="We apologize for this inconvenience. The provider is not available at this time. I can call you to reschedule if you'd like?">Apology</div>
<div class="copy-box" data-message="Discúlpenos por la inconveniencia. Esta ocasión no se encuentra el proveedor. Puedo llamarlo(a) si quiere para reprogramar.">Apology (Spanish)</div>
<div class="copy-box" data-message="To ensure we get all the correct medication information may I call you?">Medication Request</div>
<div class="copy-box" data-message="Para asegurarnos de adquirir la información correcta de medicamentos, ¿puedo llamarlo(a)?">Medication Request (Spanish)</div>
<div class="copy-box" data-message="(Name) has an appt on (Date) at (Time) at U of U Health (Location).">Confirm other Appt</div>
<div class="copy-box" data-message="(Name) tiene una cita el (Date) a las (Time) en U of U Health (Location).">Confirm other Appt (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Your provider has requested you make an appointment. Please call UofU Health (service line/dept) for more information and to schedule">Provider request appt</div>

</div>

<div class="squircle-foreground">

<h3 id="SMS PT Wait List"><span class="material-symbols-outlined" style="color: black; font-size: 25px;">physical_therapy</span><b> PT Wait List</b></h3>
<div class="info">
<span class="material-symbols-outlined" style="font-size: 20px; color: blue">info</span> See Also: Initiatives: </b><a href="#PT Wait List">PT Wait List</a>
</div>

<div class="copy-box" data-message="UofU Health: (PT NAME), an earlier visit is available: Existing visit: 00/00 at 00:00 AM/PM PROVIDER NAME New visit: 00/00 at 00:00 AM/PM This has been offered to multiple patients. Don't delay. Reply 1 to accept.">Identity Verification Text (RESCHEDULE Appt)</div>
<div class="copy-box" data-message="UofU Health: (PT NAME), una visita anterior está disponible: Visita existente: 00/00 a las 00:00 AM/PM (PROVIDER NAME) Nueva visita: 00/00 a las 00:00 AM/PM Esto se ha ofrecido a varios pacientes. No te demores.  Responda 1 para aceptar.">Identity Verification Text (RESCHEDULE Appt) (Spanish)</div>
<div class="copy-box" data-message="UofU Health: (PT NAME), an additional visit is available: New visit: 00/00 at 00:00 AM/PM PROVIDER NAME This has been offered to multiple patients. Don't delay. Reply 1 to accept.">Identity Verification Text (ADD Appt)</div>
<div class="copy-box" data-message="UofU Health: (PT NAME), hay una visita adicional disponible: Nueva visita: 00/00 a las 00:00 AM/PM (PROVIDER NAME) Esto se ha ofrecido a varios pacientes. No te demores.  Responda 1 para aceptar.">Identity Verification Text (ADD Appt) (Spanish)</div>
<div class="copy-box" data-message="Success! (NAME), your updated visit is now scheduled on 00/00 at 0:00 am/pm. You can find information about your visit in MyChart.">Question 1 - Accept (Reply 1)</div>
<div class="copy-box" data-message="¡Éxito! (NAME), su visita actualizada ahora está programada para el 00/00 a las 0:00 AM/PM Puede encontrar información sobre su visita en MyChart.">Question 1 - Accept (Reply 1) (Spanish)</div>
<div class="copy-box" data-message="Thank you for letting us know. You'll be notified again if another time becomes available. Your original visit remains available in Mychart.">Pt declines offer</div>
<div class="copy-box" data-message="Gracias por hacérnoslo saber. Se le notificará nuevamente si hay otro horario disponible. Su visita original sigue estando disponible en Mychart.">Pt declines offer (Spanish)</div>
<div class="copy-box" data-message="Sorry, this visit is no longer available. You'll be notified again if a new time becomes available.">Response received outside of offer timeframe</div>
<div class="copy-box" data-message="Lo sentimos, esta visita ya no está disponible. Se le notificará nuevamente si hay una nueva hora disponible.">Response received outside of offer timeframe (Spanish)</div>
<div class="copy-box" data-message="Thank you for letting us know. You won't receive any more offers for this appointment.">Remove from Waitlist</div>
<div class="copy-box" data-message="Gracias por hacérnoslo saber. No recibirás más ofertas para esta cita.">Remove from Waitlist (Spanish)</div>

</div>

<div class="squircle-foreground">

<h3 id="Inpatient Follow Up"><span class="material-symbols-outlined" style="color: black; font-size: 25px;">inpatient</span><b> Inpatient Follow Up</b></h3>

<div class="copy-box" data-message="UofU Health: (NAME), you need to follow up with your Primary Care provider. Text your last name and zip code to schedule or text CALL to schedule by phone.">Initial Outreach</div>
<div class="copy-box" data-message="UofU Health: (NAME), necesitas realizar un seguimiento con tu proveedor de atención primaria. Envía tu apellido y código postal para programar o escribe LLAMADA para hacerlo por teléfono.">Initial Outreach (Spanish)</div>
<div class="copy-box" data-message="Thank you. Our team will call you shortly from 801-213-9500.">Response: CALL</div>
<div class="copy-box" data-message="Gracias. Nuestro equipo te llamará en breve desde el 801-213-9500.">Response: CALL (Spanish)</div>
<div class="copy-box" data-message="Thank you. To schedule an in office visit, text OFFICE. To schedule a video visit, text VIDEO.">Text 1 - Response: Name & Zip Code</div>
<div class="copy-box" data-message="Gracias. Para programar una cita en la oficina, escribe OFICINA. Para una visita por video, escribe VIDEO.">Text 1 - Response: Name & Zip Code (Spanish)</div>
<div class="copy-box" data-message="A visit is available with (Provider) at (LOC) on 0/0 at 0:00am/pm. Text YES to accept or NO to see other options.">Response: OFFICE</div>
<div class="copy-box" data-message="Hay una cita disponible con (PROVIDER) en (LOCATION) el 0/0 a las 0:00am/pm. Responde SÍ para aceptar o NO para ver otras opciones.">Response: OFFICE (Spanish)</div>
<div class="copy-box" data-message="A video visit is available with (PROVIDER) on 0/0 at 0:00am/pm. Text YES to accept or NO to see other options.">Response: VIRTUAL</div>
<div class="copy-box" data-message="Una visita por video está disponible con (PROVIDER) el 0/0 a las 0:00am/pm. Responde SÍ para aceptar o NO para ver otras opciones.">Response: VIRTUAL (Spanish)</div>
<div class="copy-box" data-message="Your visit is confirmed. Contact your insurance to verify coverage for provider and facility. To cancel, reschedule or for questions, call 801-213-9500. Thank you.">Response (1st offer): YES (Accept)</div>
<div class="copy-box" data-message="Tu cita está confirmada. Si necesitas cancelar, reprogramar o tienes preguntas, llama al 801-213-9500. Gracias.">Response (1st offer): YES (Accept) (Spanish)</div>

<b>Response (1st offer): NO (Decline)</b> - Same offer script but offering a different date/time.

<div class="copy-box" data-message="Your visit is confirmed. Contact your insurance to verify coverage for provider and facility. To cancel, reschedule or for questions, call 801-213-9500. Thank you.">Response (2nd offer): YES (Accept)</div>
<div class="copy-box" data-message="Tu cita está confirmada. Si necesitas cancelar, reprogramar o tienes preguntas, llama al 801-213-9500. Gracias.">Response (2nd offer): YES (Accept) (Spanish)</div>
<div class="copy-box" data-message="One of our team members will call you to discuss more scheduling options. Expect a call from 801-213-9500 shortly.">Response (2nd offer): NO (Decline)</div>
<div class="copy-box" data-message="Un miembro de nuestro equipo te llamará para hablar sobre más opciones de programación. Espera la llamada desde el 801-213-9500 en breve.">Response (2nd offer): NO (Decline) (Spanish)</div>
<div class="copy-box" data-message="UofU Health: Your visit is scheduled on (date) at (time) at (Location). For details or to reschedule, call 801-213-9500 or login to MyChart. Please verify insurance coverage prior to visit.">If no response from initial outreach</div>
<div class="copy-box" data-message="UofU Health: Su visita está programada para el (DATE) a (TIME) en (LOCATION). Para obtener detalles o para reprogramar, llame al 801-213-9500 o inicie sesión en MyChart. Verifique la cobertura del seguro antes de la visita.">If no response from initial outreach (Spanish)</div>

</div>

<div class="squircle-foreground">

<h3 id="Kidney Non Compliant"><span class="material-symbols-outlined" style="color: black; font-size: 25px;">nephrology</span><b> Kidney Non Compliant</b></h3>

<div class="copy-box" data-message="UofU Health: (NAME), an appointment has been scheduled for you on 00/00 at 0:00 at (Location). To reschedule or cancel, or if you are receiving care with an external provider, please call 801-581-2634 or log in to MyChart.">In Office</div>
<div class="copy-box" data-message="UofU Health: (NAME), hemos programado una cita para usted el 00/00 a las 0:00 en (LOCATION). Para reprogramar o cancelar, o si está recibiendo atención con un proveedor externo, llame al 801-581-2634 o ingrese a MyChart.">In Office (Spanish)</div>
<div class="copy-box" data-message="UofU Health: (NAME), a video visit has been scheduled for you on 00/00 at 0:00. To reschedule or cancel, or if you are receiving care with an external provider, please call 801-581-2634 or log in to MyChart.">Virtual</div>
<div class="copy-box" data-message="UofU Health: (NAME), hemos programado una visita por video para usted el 00/00 a las 0:00. Para reprogramar o cancelar, o si está recibiendo atención con un proveedor externo, llame al 801-581-2634 o ingrese a MyChart.">Virtual (Spanish)</div>
<div class="copy-box" data-message="UofU Health: (NAME), an appointment has been scheduled for you on 00/00 at 0:00 at (LOCATION). Please complete lab work 1-2 days prior to this visit. To reschedule or cancel, or if you are receiving care with an external provider, please call 801-581-2634 or log in to MyChart.">In Office (Lab Work Required)</div>
<div class="copy-box" data-message="UofU Health: (NAME), se ha programado una cita para usted el 00/00 a las 0:00 en (LOCATION). Complete los análisis de laboratorio 1-2 días antes de esta visita. Para reprogramar o cancelar, o si está recibiendo atención con un proveedor externo, llame al 801-581-2634 o inicie sesión en MyChart.">In Office (Lab Work Required) (Spanish)</div>
<div class="copy-box" data-message="UofU Health: (NAME), a video visit has been scheduled for you on 00/00 at 0:00. Please complete lab work 1-2 days prior to this visit. To reschedule or cancel, or if you are receiving care with an external provider, please call 801-581-2634 or log in to MyChart.">Virtual (Lab Work Required)</div>
<div class="copy-box" data-message="UofU Health: (NAME), se ha programado una visita por video para usted el 00/00 a las 0:00. Complete los análisis de laboratorio 1-2 días antes de esta visita. Para reprogramar o cancelar, o si está recibiendo atención con un proveedor externo, llame al 801-581-2634 o inicie sesión en MyChart.">Virtual (Lab Work Required) (Spanish)</div>

<b>FOLLOW PROCESS BELOW FOR OUT OF STATE PATIENTS ONLY</b>

<div class="copy-box" data-message="UofU Health: (NAME), we are attempting to gather information regarding your compliance status. To continue via text, respond with your last name and zip code. If you prefer, call 801-581-2634.">Initial Outreach</div>
<div class="copy-box" data-message="UofU Health: (NAME), estamos intentando recopilar información sobre tu estado de cumplimiento. Para continuar por mensaje de texto, responde con tu apellido y código postal. Si prefieres, llama al 801-581-2634.">Initial Outreach (Spanish)</div>
<div class="copy-box" data-message="Thank you. You have not completed required follow up care with our kidney transplant team. Have you received this care outside of UofU Health? Reply: YES or NO">Text 1</div>
<div class="copy-box" data-message="Gracias. No has completado el seguimiento necesario con nuestro equipo de trasplante de riñón. ¿Recibiste esta atención fuera de UofU Health? Responde: SÍ o NO.">Text 1 (Spanish)</div>
<div class="copy-box" data-message="Can you please provide the name, address and phone number of the facility where you are receiving care?">Text 1 - (Response: YES)</div>
<div class="copy-box" data-message="¿Podrías darnos el nombre, dirección y teléfono del centro donde estás recibiendo atención?">Text 1 - (Response: YES) (Spanish)</div>
<div class="copy-box" data-message="This information has been shared with your transplant team. We will reach out if further information is needed. Thank you.">Response - Outside Facility</div>
<div class="copy-box" data-message="Esta información ya se ha compartido con tu equipo de trasplante. Nos comunicaremos si necesitamos más detalles. Gracias.">Response - Outside Facility (Spanish)</div>
<div class="copy-box" data-message="Can I help you schedule a follow up appointment now?">Text 2 - (Text 1 Response: NO)</div>
<div class="copy-box" data-message="¿Te ayudo a programar una cita de seguimiento ahora?">Text 2 - (Text 1 Response: NO) (Spanish)</div>
<div class="copy-box" data-message="Your healthcare is important to us. If you decide you would like to schedule, please call 801-581-2634. for assistance.">Response: (NO)</div>
<div class="copy-box" data-message="Tu salud es muy importante para nosotros. Si deseas programar, por favor llama al 801-581-2634 para asistencia">Response: (NO) (Spanish)</div>

</div>
</div>

<div class="squircle-background">

<h1 id="Appt Notes"><span class="material-symbols-outlined" style="color: black; font-size: 35px;">event_note</span> Appt Notes</h1>

<div class="copy-box" data-message="Call 34674 to remove hold">Call 34674 to remove hold</div>
<div class="copy-box" data-message="**CN correcting error**">**CN correcting error**</div>
<div class="copy-box" data-message="*SMS sent re appt cancelation*">*SMS sent re appt cancelation*</div>
<div class="copy-box" data-message="*SMS sent re appt time change*">*SMS sent re appt time change*</div>
<div class="copy-box" data-message="*SMS sent re change to virtual*">*SMS sent re change to virtual*</div>
<div class="copy-box" data-message="*SMS sent re location change*">*SMS sent re location change*</div>
<div class="copy-box" data-message="*SMS sent re provider change*">*SMS sent re provider change*</div>
<div class="copy-box" data-message="*MyChart message sent, If pt not billing Tricare please remove from HAR for this appt, If the patient is billing Tricare advise that an Auth # will be needed for the visit and to contact their VA PCP. If pt has other information regarding their insurance coverage, add it to appt notes. Outbound Team*">MAT/Cotiviti</div>

</div>

<div class="squircle-background">
<h1><span class="material-symbols-outlined" style="color: black; font-size: 35px;">construction</span> Utilities</h1>
<div class="squircle-foreground">
<h2 id="Sleep Test Follow-up Calculator">Sleep Test Follow-up Calculator</h2>
<br>
<form id="dateRangeForm">
  <label for="sleepTestDate">Date of Patient's Sleep Test:</label>
  <input type="date" id="sleepTestDate" name="sleepTestDate" required>
  <br>
  <button type="button" onclick="calculateSleepDateRange()">Calculate Date Range</button>
</form>
<div id="sleepResult"></div>
</div>

<script>
  function formatSleepDisplayDate(dateObj) {
    const month = dateObj.getMonth() + 1;
    const day = dateObj.getDate();
    const year = dateObj.getFullYear().toString().slice(-2);
    return `${month}/${day}/${year}`;
  }

  function calculateSleepDateRange() {
    const inputDateValue = document.getElementById('sleepTestDate').value;
    if (!inputDateValue) {
      document.getElementById('sleepResult').innerHTML = '<div class="info"><span class="material-symbols-outlined" style="font-size: 20px; color: blue">info</span> Please enter a valid date.</div>';
      return;
    }

    const inputDate = new Date(inputDateValue);
    const startRange = new Date(inputDate);
    startRange.setDate(startRange.getDate() + 61);

    const endRange = new Date(inputDate);
    endRange.setDate(endRange.getDate() + 90);

    const startFormatted = formatSleepDisplayDate(startRange);
    const endFormatted = formatSleepDisplayDate(endRange);

    document.getElementById('sleepResult').innerHTML =
      `<br><div class="info">
<span class="material-symbols-outlined" style="font-size: 20px; color: blue">info</span> Patient should be scheduled between:<br><b>${startFormatted}</b> and <b>${endFormatted}</b>.</div>`;
  }
</script>

<div class="squircle-foreground">
  <h2 id="NOB ROB Calculator">NOB/ROB Calculator</h2>
  <br>
  <div class="preg-calc-container">
    <form id="preg-calc-form" autocomplete="off">
      <div class="preg-calc-input-row">
        <label for="preg-calc-lmpDate">First Day of Last Menstrual Period (LMP):</label>
        <input type="date" id="preg-calc-lmpDate" required>
      </div>
      <button type="submit">Calculate Schedule</button>
    </form>
    <div class="preg-calc-results">
      <div class="nob-step" id="nob-step"></div>
      <div class="rob-step" id="rob-step"></div>
    </div>
  </div>
</div>
</div>
</div>
<script>
  // --- Pregnancy Calculator logic (dynamic .copy-box creation with data-message for UID/date/time support) ---
  function parseLocalDate(inputValue) {
    const [year, month, day] = inputValue.split('-').map(Number);
    return new Date(year, month - 1, day);
  }
  function addDays(date, days) {
    const result = new Date(date);
    result.setDate(result.getDate() + days);
    return result;
  }
  function formatDate(date) {
    const mm = String(date.getMonth() + 1).padStart(2, '0');
    const dd = String(date.getDate()).padStart(2, '0');
    const yy = String(date.getFullYear()).slice(-2);
    return `${mm}/${dd}/${yy}`;
  }
  function calculateGestationalWeek(lmpDate, targetDate) {
    const diffMs = targetDate - lmpDate;
    const diffDays = diffMs / (1000 * 60 * 60 * 24);
    return Math.floor(diffDays / 7); // completed weeks
  }
  function weekStartEndDates(lmpDate, weekNum) {
    const start = addDays(lmpDate, weekNum * 7);
    const end = addDays(lmpDate, weekNum * 7 + 6);
    return [start, end];
  }
  function generateROBVisits(nobDate, lmpDate) {
    const robSchedule = [];
    const nobWeek = calculateGestationalWeek(lmpDate, nobDate);
    let week = nobWeek + 4;
    while (week <= 28) {
      robSchedule.push(week);
      week += 4;
    }
    while (week <= 36) {
      robSchedule.push(week);
      week += 2;
    }
    while (week <= 42) {
      robSchedule.push(week);
      week += 1;
    }
    return robSchedule.map(wk => {
      const [fullStart, fullEnd] = weekStartEndDates(lmpDate, wk);
      return {
        week: wk,
        fullRange: [fullStart, fullEnd],
      };
    });
  }
  function generateNOBWindow(lmpDate) {
    const start = addDays(lmpDate, 8 * 7);
    const end = addDays(lmpDate, 10 * 7);
    return [start, end];
  }

  const form = document.getElementById("preg-calc-form");
  const lmpInput = document.getElementById("preg-calc-lmpDate");
  const nobStep = document.getElementById("nob-step");
  const robStep = document.getElementById("rob-step");
  let lmpDateGlobal = null;
  let nobWindowStart = null;
  let nobWindowEnd = null;

  form?.addEventListener("submit", function(e) {
    e.preventDefault();
    nobStep.innerHTML = "";
    robStep.innerHTML = "";
    robStep.classList.remove("active-step");
    const lmpStr = document.getElementById("preg-calc-lmpDate").value;
    if (!lmpStr) return;
    const lmpDate = parseLocalDate(lmpStr);
    lmpDateGlobal = lmpDate;

    [nobWindowStart, nobWindowEnd] = generateNOBWindow(lmpDate);

    let html = `
      <div class="nob-date-picker-info">
       Suggested NOB Appointment Window: <br><strong>${formatDate(nobWindowStart)} – ${formatDate(nobWindowEnd)}</strong> (8–10 weeks)
      </div>
      <form id="nob-choose-form">
        <label for="nob-date-picker"><br>When was the NOB appointment actually scheduled?</label>
        <input type="date" id="nob-date-picker" required>
        <button type="submit" style="margin-top:12px;">Continue</button>
      </form>
      <div style="font-size:0.97em;color:#888;margin-top:0.5em;">
      </div>
    `;
    nobStep.innerHTML = html;
    nobStep.classList.add("active-step");

    document.getElementById("nob-choose-form").addEventListener("submit", function(ev) {
      ev.preventDefault();
      const nobDateStr = document.getElementById("nob-date-picker").value;
      if (!nobDateStr) return;
      const nobDate = parseLocalDate(nobDateStr);

      let warning = "";
      showROBSchedule(nobDate, lmpDateGlobal, warning);
      nobStep.classList.remove("active-step");
      robStep.classList.add("active-step");
    });
  });

  function showROBSchedule(nobDate, lmpDate, warningHtml) {
    let html = `
    <h3>Recommended Appointment Schedule</h3>
    ${warningHtml || ""}
    <div style="font-size:0.97em;color:#888;margin-top:0.5em;">
    (Appt schedule may vary if an ROB appt is missed, cancelled, or bumped.)
    </div>
    <table>
      <thead>
        <tr>
          <th>Appt Note:</th>
          <th class="date-range-col">Scheduling Range</th>
        </tr>
      </thead>
      <tbody>
    `;

    // Add NOB row for clarity
    const weekAtNOB = calculateGestationalWeek(lmpDate, nobDate);
    const [nobFullStart, nobFullEnd] = weekStartEndDates(lmpDate, weekAtNOB);
    const formattedLMP = formatDate(lmpDate);
    // Use [UID] in copy message for NOB
    const nobLmpCopyText = `NOB LMP ${formattedLMP}`;

    html += `<tr>
      <td>
        <div class="copy-box appt-nob" data-message="${nobLmpCopyText}" id="nob-lmp-copy-btn">${nobLmpCopyText}</div>
      </td>
      <td class="date-range-col">${
        nobFullStart.getTime() === nobFullEnd.getTime()
          ? formatDate(nobFullStart)
          : `${formatDate(nobFullStart)} – ${formatDate(nobFullEnd)}`
      }</td>
    </tr>`;

    const robVisits = generateROBVisits(nobDate, lmpDate);
    robVisits.forEach((visit, idx) => {
      const [fullStart, fullEnd] = visit.fullRange;
      // Use [UID] in copy message for ROB
      const weekLabel = `ROB week ${visit.week}`;
      let rangeHtml =
        fullStart.getTime() === fullEnd.getTime()
          ? formatDate(fullStart)
          : `${formatDate(fullStart)} – ${formatDate(fullEnd)}`;
      html += `<tr>
        <td><div class="copy-box appt-rob" data-message="${weekLabel}" id="rob-copy-btn-${idx}">${weekLabel}</div></td>
        <td class="date-range-col">${rangeHtml}</td>
      </tr>`;
    });
    html += `</tbody></table>
    `;
    robStep.innerHTML = html;
  }
</script>

<div class="squircle-background">

<h1 id="Settings"><span class="material-symbols-outlined" style="color: black; font-size: 35px;">settings</span> Settings</h1>

<div class="squircle-foreground">

<br>
  <form id="uidForm">
    <label for="userUid">Enter Your UID (Please use lowercase u):</label>
    <input type="text" id="userUid" placeholder="UID" required>
    <button type="submit">Save UID</button>
  </form>



  <div style="margin-top: 20px;">
<div class="info">
    <p><span class="material-symbols-outlined" style="font-size: 20px; color: blue">info</span><b> UID set to: <span id="displayUid"></span></b></p>
  </div>
  </div>

</div>

<div class="squircle-foreground">

  <div>
    <input type="checkbox" id="previewToggle">
    <label for="previewToggle">Enable button previews on hover.</label>
  </div>
</div>
</div>

<div class="squircle-background">

<h1 id="About"><span class="material-symbols-outlined" style="color: black; font-size: 35px;">info</span> About</h1>

<div class="squircle-foreground">
<b>Outbound Clipboard Manager created and maintained by Joshua Reeve. 
	<br>
	<br>
	For feedback, suggestions, to report any issues you find, please send me a message in Teams, or email me at <a href="mailto:u0971743@umail.utah.edu">u0971743@umail.utah.edu</a></b>
<br>
<br>
<b>Last updated: 6/9/25</b>

</div>
</div>

<!--SCRIPTS-->
<script>
// --- UID Form and Display, Preview, and Clipboard Logic ---
const uidForm = document.getElementById("uidForm");
const displayUid = document.getElementById("displayUid");
const previewToggle = document.getElementById("previewToggle");

// Save UID
uidForm?.addEventListener("submit", function(event) {
  event.preventDefault();
  const uidInput = document.getElementById("userUid")?.value.trim();
  if (uidInput) {
    localStorage.setItem("userUid", uidInput);
    if (displayUid) displayUid.textContent = uidInput;
    alert("UID saved successfully!");
  }
});

// Show saved UID on page load
const storedUid = localStorage.getItem("userUid");
if (storedUid && displayUid) {
  displayUid.textContent = storedUid;
}

// Restore preview toggle state on load
window.addEventListener("load", () => {
  const savedState = localStorage.getItem("previewToggleState");
  if (savedState !== null && previewToggle) {
    previewToggle.checked = savedState === "true";
  }
});

// Save preview toggle state on change
previewToggle?.addEventListener("change", () => {
  localStorage.setItem("previewToggleState", previewToggle.checked);
});

// --- Preview Box (single instance) ---
const preview = document.createElement("div");
preview.className = "preview";
preview.style.position = "absolute";
preview.style.background = "#eee";
preview.style.border = "1px solid #ccc";
preview.style.padding = "4px 8px";
preview.style.display = "none";
preview.style.pointerEvents = "none";
preview.style.zIndex = "9999";
document.body.appendChild(preview);

// --- Utility to process message placeholders ---
function processMessage(template) {
  if (!template) return "";
  const now = new Date();
  const month = (now.getMonth() + 1).toString().padStart(2, '0');
  const day = now.getDate().toString().padStart(2, '0');
  const year = now.getFullYear();
  const today = `${month}/${day}/${year}`;
  const time = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
  const uid = localStorage.getItem("userUid") || "[UID not set, please set in Settings section of Outbound Clipboard Manager.]";
  return template
    .replaceAll("[DATE]", today)
    .replaceAll("[TIME]", time)
    .replaceAll("[UID]", uid);
}

// --- Copy to Clipboard function (used globally) ---
function copyText(text) {
  if (navigator.clipboard && window.isSecureContext) {
    return navigator.clipboard.writeText(text);
  } else {
    const tempInput = document.createElement('input');
    tempInput.value = text;
    document.body.appendChild(tempInput);
    tempInput.select();
    tempInput.setSelectionRange(0, 99999);
    document.execCommand('copy');
    document.body.removeChild(tempInput);
    return Promise.resolve();
  }
}

// --- Unified event delegation for .copy-box (static and dynamic) ---
document.body.addEventListener("click", function(event) {
  const button = event.target.closest(".copy-box");
  if (!button) return;
  // Prefer data-message, then data-copytext, then textContent
  let template = button.getAttribute('data-message') || button.getAttribute('data-copytext') || button.textContent.trim();
  let message = processMessage(template);
  copyText(message);
});

document.body.addEventListener("mouseover", function(event) {
  const button = event.target.closest(".copy-box");
  if (!button) return;
  if (previewToggle && previewToggle.checked) {
    let template = button.getAttribute('data-message') || button.getAttribute('data-copytext') || button.textContent.trim();
    let message = processMessage(template);
    preview.textContent = message;
    preview.style.left = `${event.pageX + 10}px`;
    preview.style.top = `${event.pageY + 10}px`;
    preview.style.display = "block";
  }
});
document.body.addEventListener("mousemove", function(event) {
  const button = event.target.closest(".copy-box");
  if (!button) return;
  if (previewToggle && previewToggle.checked) {
    preview.style.left = `${event.pageX + 10}px`;
    preview.style.top = `${event.pageY + 10}px`;
  }
});
document.body.addEventListener("mouseout", function(event) {
  const button = event.target.closest(".copy-box");
  if (!button) return;
  preview.style.display = "none";
});

// --- Custom Button/Folders Management and Rendering (with copy-box compatibility) ---
document.addEventListener('DOMContentLoaded', () => {
  // --- MIGRATION: legacy buttons to foldersV2 ---
  if (!localStorage.getItem('foldersV2') && localStorage.getItem('buttons')) {
    const legacyButtons = JSON.parse(localStorage.getItem('buttons')) || [];
    if (legacyButtons.length > 0) {
      const foldersV2 = [{
        folder: 'Migrated Buttons',
        color: '#2196F3',
        expanded: true,
        buttons: legacyButtons.map(btn => ({
          label: btn.label || btn.content.slice(0, 50),
          content: btn.content,
          color: btn.color || '#2196F3'
        }))
      }];
      localStorage.setItem('foldersV2', JSON.stringify(foldersV2));
      // Optionally: localStorage.removeItem('buttons');
    }
  }

  function getFolders() {
    return JSON.parse(localStorage.getItem('foldersV2')) || [];
  }
  function saveFolders(folders) {
    localStorage.setItem('foldersV2', JSON.stringify(folders));
  }

  const foldersContainer = document.getElementById('foldersContainer');

  // --- Modal helpers ---
  function showModal(content, onClose) {
    const overlay = document.createElement('div');
    overlay.className = 'modal-overlay';
    overlay.onclick = () => {
      document.body.removeChild(overlay);
      if (onClose) onClose();
    };
    if (!(content instanceof HTMLElement)) {
      const modal = document.createElement('div');
      modal.className = 'modal-dialog';
      modal.appendChild(content);
      overlay.appendChild(modal);
    } else {
      content.onclick = e => e.stopPropagation();
      overlay.appendChild(content);
    }
    document.body.appendChild(overlay);
    const firstInput = overlay.querySelector('input,textarea,select,button');
    if (firstInput) firstInput.focus();
  }

  // --- Add Folder Modal with Title and Labels ---
  function showAddFolderModal(onFolderAdded) {
    const form = document.createElement('form');
    form.style.display = 'flex';
    form.style.flexDirection = 'column';
    form.style.gap = '10px';

    // Modal Title
    const title = document.createElement('h2');
    title.textContent = "New Folder";
    form.appendChild(title);

    // Folder Name
    const nameLabel = document.createElement('label');
    nameLabel.textContent = "Folder Name:";
    nameLabel.htmlFor = "modalFolderNameInput";
    const nameInput = document.createElement('input');
    nameInput.type = 'text';
    nameInput.id = "modalFolderNameInput";
    nameInput.placeholder = 'Folder name';
    nameInput.required = true;

    // Folder Color
    const colorLabel = document.createElement('label');
    colorLabel.textContent = "Folder Color:";
    colorLabel.htmlFor = "modalFolderColorInput";
    const colorInput = document.createElement('input');
    colorInput.type = 'color';
    colorInput.id = "modalFolderColorInput";
    colorInput.value = '#2196f3';
    colorInput.title = "Pick a folder color";
    colorInput.style.width = '60px';
    colorInput.style.height = '36px';

    // Add/Cancel
    const addBtn = document.createElement('button');
    addBtn.type = 'submit';
    addBtn.textContent = 'Add Folder';

    const cancelBtn = document.createElement('button');
    cancelBtn.type = 'button';
    cancelBtn.textContent = 'Cancel';
    cancelBtn.onclick = (e) => {
      e.preventDefault();
      document.body.removeChild(form.closest('.modal-overlay'));
    };

    form.appendChild(nameLabel);
    form.appendChild(nameInput);
    form.appendChild(colorLabel);
    form.appendChild(colorInput);
    form.appendChild(addBtn);
    form.appendChild(cancelBtn);

    form.onsubmit = (e) => {
      e.preventDefault();
      if (onFolderAdded) onFolderAdded({
        name: nameInput.value.trim(),
        color: colorInput.value
      });
      document.body.removeChild(form.closest('.modal-overlay'));
    };

    showModal(form);
  }

  // --- Add Button Modal with Title and Labels ---
  function showAddButtonModal(folders, onButtonAdded) {
    const form = document.createElement('form');
    form.style.display = 'flex';
    form.style.flexDirection = 'column';
    form.style.gap = '10px';

    // Modal Title
    const title = document.createElement('h2');
    title.textContent = "New Button";
    form.appendChild(title);

    // Button Label
    const labelLabel = document.createElement('label');
    labelLabel.textContent = "Button Label:";
    labelLabel.htmlFor = "modalButtonLabelInput";
    const textInput = document.createElement('input');
    textInput.type = 'text';
    textInput.id = "modalButtonLabelInput";
    textInput.placeholder = 'Button label (optional)';

    // Button Content
    const contentLabel = document.createElement('label');
    contentLabel.textContent = "Button Content:";
    contentLabel.htmlFor = "modalButtonContentInput";
    const contentInput = document.createElement('textarea');
    contentInput.id = "modalButtonContentInput";
    contentInput.placeholder = 'Button content';
    contentInput.required = true;
    contentInput.rows = 3;

    // Button Color
    const colorLabel = document.createElement('label');
    colorLabel.textContent = "Button Color:";
    colorLabel.htmlFor = "modalButtonColorSelect";
    const colorInput = document.createElement('select');
    colorInput.id = "modalButtonColorSelect";
    colorInput.innerHTML = `
      <option value="#2196F3">Material Blue (Default)</option>
      <option value="red">Red</option>
      <option value="orange">Orange</option>
      <option value="yellow">Yellow</option>
      <option value="green">Green</option>
      <option value="blue">Blue</option>
      <option value="purple">Purple</option>
      <option value="gray">Gray</option>
      <option value="chartreuse">Chartreuse</option>
      <option value="cornflowerblue">CornflowerBlue</option>
      <option value="goldenrod">GoldenRod</option>
      <option value="orchid">Orchid</option>
      <option value="salmon">Salmon</option>
    `;
    colorInput.required = true;

    // Button Folder
    const folderLabel = document.createElement('label');
    folderLabel.textContent = "Folder:";
    folderLabel.htmlFor = "modalButtonFolderSelect";
    const folderSelect = document.createElement('select');
    folderSelect.id = "modalButtonFolderSelect";
    folders.forEach((folder, idx) => {
      const opt = document.createElement('option');
      opt.value = idx;
      opt.textContent = folder.folder;
      folderSelect.appendChild(opt);
    });

    // Add/Cancel
    const addBtn = document.createElement('button');
    addBtn.type = 'submit';
    addBtn.textContent = 'Add Button';

    const cancelBtn = document.createElement('button');
    cancelBtn.type = 'button';
    cancelBtn.textContent = 'Cancel';
    cancelBtn.onclick = (e) => {
      e.preventDefault();
      document.body.removeChild(form.closest('.modal-overlay'));
    };

    form.appendChild(labelLabel);
    form.appendChild(textInput);
    form.appendChild(contentLabel);
    form.appendChild(contentInput);
    form.appendChild(colorLabel);
    form.appendChild(colorInput);
    form.appendChild(folderLabel);
    form.appendChild(folderSelect);
    form.appendChild(addBtn);
    form.appendChild(cancelBtn);

    form.onsubmit = (e) => {
      e.preventDefault();
      if (!contentInput.value.trim()) {
        contentInput.focus();
        return;
      }
      if (onButtonAdded) onButtonAdded({
        label: textInput.value.trim() || contentInput.value.trim().slice(0, 50),
        content: contentInput.value.trim(),
        color: colorInput.value,
        folderIdx: folderSelect.value | 0
      });
      document.body.removeChild(form.closest('.modal-overlay'));
    };

    showModal(form);
  }

  // --- Add Folder Button Modal Logic ---
  document.getElementById('openAddFolderModal').onclick = () => {
    showAddFolderModal(({ name, color }) => {
      const folders = getFolders();
      folders.push({ folder: name, color, expanded: true, buttons: [] });
      saveFolders(folders);
      renderFolders();
      updateFolderDropdown();
    });
  };

  // --- Add Button Modal Logic ---
  document.getElementById('openAddButtonModal').onclick = () => {
    const folders = getFolders();
    if (folders.length === 0) {
      alert("Please create a folder first.");
      return;
    }
    showAddButtonModal(folders, ({ label, content, color, folderIdx }) => {
      const folders = getFolders();
      folders[folderIdx].buttons.push({ label, content, color });
      saveFolders(folders);
      renderFolders();
      updateFolderDropdown();
    });
  };

  // --- Folders and Buttons Rendering ---
  function renderFolders() {
    foldersContainer.innerHTML = '';
    const folders = getFolders();

    let draggedFolderIdx = null;

    folders.forEach((folder, folderIdx) => {
      // Folder container
      const folderDiv = document.createElement('div');
      folderDiv.className = 'folder-div';
      folderDiv.style.border = `1px solid ${folder.color || '#2196F3'}`;
      folderDiv.style.background = "#ffffff";

      // Collapsible header
      const header = document.createElement('div');
      header.className = 'folder-header';
      header.style.display = 'flex';
      header.style.justifyContent = 'space-between';
      header.style.alignItems = 'center';
      header.style.padding = '0px';
      header.style.cursor = 'pointer';
      header.style.background = folder.color || '#2196F3';
      header.style.color = '#fff';
      header.draggable = true;

      // --- Folder Drag & Drop Logic ONLY ON HEADER ---
      header.addEventListener('dragstart', (e) => {
        draggedFolderIdx = folderIdx;
        e.dataTransfer.setData('type', 'folder');
        e.dataTransfer.setData('folderIdx', folderIdx);
        e.dataTransfer.effectAllowed = "move";
      });
      header.addEventListener('dragend', () => {
        header.classList.remove('dragging');
        document.querySelectorAll('.folder-div.folder-drop-target').forEach(el=>el.classList.remove('folder-drop-target'));
      });

      // Folder drop target (only responds to folder drags)
      folderDiv.addEventListener('dragover', (e) => {
        if (e.dataTransfer.getData('type') === 'folder') {
          e.preventDefault();
          folderDiv.classList.add('folder-drop-target');
        }
      });
      folderDiv.addEventListener('dragleave', () => {
        folderDiv.classList.remove('folder-drop-target');
      });
      folderDiv.addEventListener('drop', (e) => {
        e.preventDefault();
        folderDiv.classList.remove('folder-drop-target');
        if (e.dataTransfer.getData('type') === 'folder') {
          const fromIdx = parseInt(e.dataTransfer.getData('folderIdx'), 10);
          if (!isNaN(fromIdx) && fromIdx !== folderIdx) {
            const foldersNow = getFolders();
            const [moved] = foldersNow.splice(fromIdx, 1);
            foldersNow.splice(folderIdx, 0, moved);
            saveFolders(foldersNow);
            renderFolders();
          }
        }
        draggedFolderIdx = null;
      });

      // Expand/collapse icon
      const expandIcon = document.createElement('span');
      expandIcon.className = 'material-symbols-outlined';
      expandIcon.style.marginRight = "5px";
      expandIcon.style.marginLeft = "5px";
      expandIcon.textContent = folder.expanded ? "folder_open" : "folder";
      header.prepend(expandIcon);

      // Folder name
      const title = document.createElement('span');
      title.textContent = folder.folder;
      title.style.fontWeight = "bold";
      header.appendChild(title);

      // Folder controls (edit, delete)
      const controls = document.createElement('div');
      controls.className = "controls";

      // Edit folder
      const editBtn = document.createElement('button');
      editBtn.innerHTML = '<span class="material-symbols-outlined">edit</span>';
      editBtn.title = "Edit Folder";
      editBtn.style.background = "#FFD600";
      editBtn.style.color = "#212121";
      editBtn.style.marginLeft = "4px";
      editBtn.onclick = (e) => {
        e.stopPropagation();
        openEditFolderModal(folderIdx);
      };
      // Delete folder
      const delBtn = document.createElement('button');
      delBtn.innerHTML = '<span class="material-symbols-outlined">delete</span>';
      delBtn.title = "Delete Folder";
      delBtn.style.background = "#F44336";
      delBtn.style.color = "#fff";
      delBtn.style.marginLeft = "4px";
      delBtn.style.marginRight = "1px";
      delBtn.onclick = (e) => {
        e.stopPropagation();
        if (confirm('Delete this folder and all its buttons?')) {
          folders.splice(folderIdx, 1);
          saveFolders(folders);
          renderFolders();
        }
      };
      controls.appendChild(editBtn);
      controls.appendChild(delBtn);

      header.appendChild(controls);

      // Expand/collapse
      header.addEventListener('click', () => {
        folder.expanded = !folder.expanded;
        saveFolders(folders);
        renderFolders();
      });

      folderDiv.appendChild(header);

      // Buttons list (drop area)
      const buttonsList = document.createElement('div');
      buttonsList.className = 'buttons-list';
      if (!folder.expanded) buttonsList.style.display = 'none';
      buttonsList.style.minHeight = '20px';
      buttonsList.style.padding = '8px';

      // Button drag/drop highlight
      buttonsList.addEventListener('dragover', (e) => {
        e.preventDefault();
        buttonsList.classList.add('button-drop-target');
      });
      buttonsList.addEventListener('dragleave', () => {
        buttonsList.classList.remove('button-drop-target');
      });
      buttonsList.addEventListener('drop', (e) => {
        e.preventDefault();
        buttonsList.classList.remove('button-drop-target');
        const dragged = JSON.parse(e.dataTransfer.getData('text'));
        if (dragged.folderIdx !== folderIdx) {
          // Remove from old folder
          const foldersNow = getFolders();
          const [btn] = foldersNow[dragged.folderIdx].buttons.splice(dragged.buttonIdx, 1);
          foldersNow[folderIdx].buttons.push(btn);
          saveFolders(foldersNow);
          renderFolders();
        }
      });

      // Render each button
      folder.buttons.forEach((btn, buttonIdx) => {
        const buttonDiv = document.createElement('div');
        buttonDiv.className = 'copy-box';
        buttonDiv.style.background = btn.color;
        buttonDiv.draggable = true;
        buttonDiv.style.margin = "4px 0";
        buttonDiv.style.display = "flex";
        buttonDiv.style.alignItems = "center";
        buttonDiv.style.padding = "0";
        buttonDiv.style.borderRadius = "4px";
        buttonDiv.style.cursor = "pointer";
        buttonDiv.style.position = "relative";
        buttonDiv.title = btn.content;
        // Key for UID/date/time: set content as data-message!
        buttonDiv.setAttribute("data-message", btn.content);

        // Copy label
        const labelSpan = document.createElement('span');
        labelSpan.textContent = btn.label;
        labelSpan.style.flex = "1";
        // Remove direct clipboard copy: global handler now handles all
        // labelSpan.onclick = (e) => {
        //   e.stopPropagation();
        //   navigator.clipboard.writeText(btn.content);
        // };

        // Edit button
        const edit = document.createElement('button');
        edit.innerHTML = '<span class="material-symbols-outlined" style="font-size: 16px;">edit</span>';
        edit.style.background = "#FFD600";
        edit.style.color = "#212121";
        edit.style.marginLeft = "4px";
        edit.style.paddingLeft = "2px";
        edit.style.paddingRight = "2px";
        edit.onclick = (e) => {
          e.stopPropagation();
          openEditButtonModal(folderIdx, buttonIdx);
        };

        // Delete button
        const del = document.createElement('button');
        del.innerHTML = '<span class="material-symbols-outlined" style="font-size: 16px;">delete</span>';
        del.style.background = "#F44336";
        del.style.color = "#fff";
        del.style.marginLeft = "4px";
        del.style.paddingLeft = "2px";
        del.style.marginRight = "4px";
        del.style.paddingRight = "2px";
        del.onclick = (e) => {
          e.stopPropagation();
          if (confirm('Delete this button?')) {
            folder.buttons.splice(buttonIdx, 1);
            saveFolders(folders);
            renderFolders();
          }
        };

        // Actions container
        const actionsDiv = document.createElement('div');
        actionsDiv.style.display = "flex";
        actionsDiv.appendChild(edit);
        actionsDiv.appendChild(del);

        // Layout: label (copy), edit, delete
        buttonDiv.appendChild(labelSpan);
        buttonDiv.appendChild(actionsDiv);

        // Drag & drop logic
        buttonDiv.addEventListener('dragstart', e => {
          e.dataTransfer.setData('text', JSON.stringify({
            folderIdx, buttonIdx, button: btn
          }));
          setTimeout(() => (buttonDiv.style.opacity = "0.5"), 0);
        });
        buttonDiv.addEventListener('dragend', () => {
          buttonDiv.style.opacity = "1";
        });
        buttonDiv.addEventListener('dragover', (e) => {
          e.preventDefault();
        });
        buttonDiv.addEventListener('drop', (e) => {
          e.preventDefault();
          const dragged = JSON.parse(e.dataTransfer.getData('text'));
          const foldersNow = getFolders();
          if (dragged.folderIdx === folderIdx) {
            // Move within this folder
            const [btn] = foldersNow[folderIdx].buttons.splice(dragged.buttonIdx, 1);
            let targetIdx = buttonIdx;
            if (dragged.buttonIdx < buttonIdx) targetIdx--;
            foldersNow[folderIdx].buttons.splice(targetIdx, 0, btn);
            saveFolders(foldersNow);
            renderFolders();
          }
        });

        buttonsList.appendChild(buttonDiv);
      });

      folderDiv.appendChild(buttonsList);
      foldersContainer.appendChild(folderDiv);
    });
  }

  // --- Edit Button Modal ---
  function openEditButtonModal(folderIdx, buttonIdx) {
    const folders = getFolders();
    const btn = folders[folderIdx].buttons[buttonIdx];
    const overlay = document.createElement('div');
    overlay.className = 'modal-overlay';
    overlay.onclick = () => document.body.removeChild(overlay);

    const modal = document.createElement('div');
    modal.className = 'modal-dialog';
    modal.onclick = (e) => e.stopPropagation();

    // Modal Title
    const title = document.createElement('h2');
    title.textContent = "Edit Button";
    modal.appendChild(title);

    // Inputs
    const labelLabel = document.createElement('label');
    labelLabel.textContent = "Button Label:";
    const labelInput = document.createElement('input');
    labelInput.type = 'text';
    labelInput.value = btn.label;

    const contentLabel = document.createElement('label');
    contentLabel.textContent = "Button Content:";
    const contentInput = document.createElement('textarea');
    contentInput.value = btn.content;
    contentInput.rows = 3;

    const colorLabel = document.createElement('label');
    colorLabel.textContent = "Button Color:";
    const colorInput = document.createElement('input');
    colorInput.type = 'text';
    colorInput.value = btn.color;

    // Save/Cancel
    const saveBtn = document.createElement('button');
    saveBtn.textContent = "Save";
    saveBtn.onclick = () => {
      btn.label = labelInput.value.trim() || btn.content.slice(0, 50);
      btn.content = contentInput.value;
      btn.color = colorInput.value.trim() || btn.color;
      saveFolders(folders);
      document.body.removeChild(overlay);
      renderFolders();
    };
    const cancelBtn = document.createElement('button');
    cancelBtn.textContent = "Cancel";
    cancelBtn.onclick = () => document.body.removeChild(overlay);

    // Layout
    modal.appendChild(labelLabel);
    modal.appendChild(labelInput);
    modal.appendChild(document.createElement('br'));
    modal.appendChild(contentLabel);
    modal.appendChild(contentInput);
    modal.appendChild(document.createElement('br'));
    modal.appendChild(colorLabel);
    modal.appendChild(colorInput);
    modal.appendChild(document.createElement('br'));
    modal.appendChild(saveBtn);
    modal.appendChild(cancelBtn);

    overlay.appendChild(modal);
    document.body.appendChild(overlay);
  }

  function openEditFolderModal(folderIdx) {
    const folders = getFolders();
    const folder = folders[folderIdx];
    const overlay = document.createElement('div');
    overlay.className = 'modal-overlay';
    overlay.onclick = () => document.body.removeChild(overlay);

    const modal = document.createElement('div');
    modal.className = 'modal-dialog';
    modal.onclick = (e) => e.stopPropagation();

    // Modal Title
    const title = document.createElement('h2');
    title.textContent = "Edit Folder";
    modal.appendChild(title);

    // Inputs
    const nameLabel = document.createElement('label');
    nameLabel.textContent = "Folder Name:";
    nameLabel.style.display = "block";
    nameLabel.style.marginTop = "8px";
    const nameInput = document.createElement('input');
    nameInput.type = 'text';
    nameInput.value = folder.folder;
    nameInput.style.width = "90%";

    const colorLabel = document.createElement('label');
    colorLabel.textContent = "Folder Color:";
    colorLabel.style.display = "block";
    colorLabel.style.marginTop = "8px";
    const colorInput = document.createElement('input');
    colorInput.type = 'color';
    colorInput.value = folder.color || '#2196F3';
    colorInput.style.width = "50px";
    colorInput.style.height = "36px";
    colorInput.style.border = "none";
    colorInput.style.background = "none";
    colorInput.style.marginTop = "4px";
    colorInput.style.marginBottom = "10px";

    // Save/Cancel
    const saveBtn = document.createElement('button');
    saveBtn.textContent = "Save";
    saveBtn.style.marginRight = "10px";
    saveBtn.onclick = () => {
      const newName = nameInput.value.trim();
      if (!newName) {
        nameInput.focus();
        return;
      }
      folder.folder = newName;
      folder.color = colorInput.value;
      saveFolders(folders);
      document.body.removeChild(overlay);
      renderFolders();
    };
    const cancelBtn = document.createElement('button');
    cancelBtn.textContent = "Cancel";
    cancelBtn.onclick = () => document.body.removeChild(overlay);

    // Layout
    modal.appendChild(nameLabel);
    modal.appendChild(nameInput);
    modal.appendChild(colorLabel);
    modal.appendChild(colorInput);
    modal.appendChild(document.createElement('br'));
    modal.appendChild(saveBtn);
    modal.appendChild(cancelBtn);

    overlay.appendChild(modal);
    document.body.appendChild(overlay);

    nameInput.focus();
  }

  // Initial render
  renderFolders();
  function updateFolderDropdown() {
    // For legacy/form compatibility only!
    const folderSelect = document.getElementById('addButtonFolderSelect');
    if (!folderSelect) return;
    folderSelect.innerHTML = '';
    const folders = getFolders();
    folders.forEach((folder, idx) => {
      const opt = document.createElement('option');
      opt.value = idx;
      opt.textContent = folder.folder;
      folderSelect.appendChild(opt);
    });
    folderSelect.disabled = folders.length === 0;
  }
  updateFolderDropdown();

  // --- Export/Import Folders/Buttons ---
  document.getElementById('exportFolders').addEventListener('click', function() {
    const folders = JSON.parse(localStorage.getItem('foldersV2') || '[]');
    const dataStr = JSON.stringify(folders, null, 2);
    const blob = new Blob([dataStr], {type: "application/json"});
    const url = URL.createObjectURL(blob);

    const a = document.createElement('a');
    a.href = url;
    a.download = 'folders_backup.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });

  document.getElementById('importFolders').addEventListener('click', function() {
    document.getElementById('importFileInput').click();
  });

  document.getElementById('importFileInput').addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
      try {
        const importedFolders = JSON.parse(e.target.result);
        if (!Array.isArray(importedFolders)) throw new Error("Invalid format");
        if (!confirm("Importing will replace all your current folders and buttons. Continue?")) return;
        localStorage.setItem('foldersV2', JSON.stringify(importedFolders));
        alert('Folders/Buttons imported successfully!\n\nThe page will now reload to apply changes.');
        location.reload();
      } catch (err) {
        alert('Failed to import: Invalid file format.');
      }
    };
    reader.readAsText(file);
  });
});
</script>
</body>
</html>
